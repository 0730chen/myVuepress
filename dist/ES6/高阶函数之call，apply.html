<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>实现call，apply，bind,new | Atom</title>
    <meta name="description" content="敲就硬敲">
    
    
    <link rel="preload" href="/assets/css/0.styles.b6a95b11.css" as="style"><link rel="preload" href="/assets/js/app.7506ff96.js" as="script"><link rel="preload" href="/assets/js/2.e528d5f4.js" as="script"><link rel="preload" href="/assets/js/14.fae9289b.js" as="script"><link rel="prefetch" href="/assets/js/10.b5d790a4.js"><link rel="prefetch" href="/assets/js/11.df35d760.js"><link rel="prefetch" href="/assets/js/12.a375e8af.js"><link rel="prefetch" href="/assets/js/13.3ac25f91.js"><link rel="prefetch" href="/assets/js/15.b76dd73b.js"><link rel="prefetch" href="/assets/js/16.4384cfac.js"><link rel="prefetch" href="/assets/js/17.2f659bb3.js"><link rel="prefetch" href="/assets/js/18.1ef10940.js"><link rel="prefetch" href="/assets/js/19.68e54be5.js"><link rel="prefetch" href="/assets/js/20.034035c4.js"><link rel="prefetch" href="/assets/js/21.f3f4da3c.js"><link rel="prefetch" href="/assets/js/22.7533c909.js"><link rel="prefetch" href="/assets/js/23.51412dc8.js"><link rel="prefetch" href="/assets/js/24.e2ea2d14.js"><link rel="prefetch" href="/assets/js/25.49f91336.js"><link rel="prefetch" href="/assets/js/26.0db6b814.js"><link rel="prefetch" href="/assets/js/27.08725fc1.js"><link rel="prefetch" href="/assets/js/28.5c218ea2.js"><link rel="prefetch" href="/assets/js/29.81d4e3ce.js"><link rel="prefetch" href="/assets/js/3.35d14061.js"><link rel="prefetch" href="/assets/js/30.e9071d1a.js"><link rel="prefetch" href="/assets/js/31.a6b602b2.js"><link rel="prefetch" href="/assets/js/32.bea8a797.js"><link rel="prefetch" href="/assets/js/33.c63d4dfe.js"><link rel="prefetch" href="/assets/js/34.332f4b39.js"><link rel="prefetch" href="/assets/js/35.00649dc7.js"><link rel="prefetch" href="/assets/js/36.a4d35644.js"><link rel="prefetch" href="/assets/js/37.af80d8b1.js"><link rel="prefetch" href="/assets/js/38.52f946d3.js"><link rel="prefetch" href="/assets/js/39.f0e97758.js"><link rel="prefetch" href="/assets/js/4.5e47662d.js"><link rel="prefetch" href="/assets/js/40.309d14a8.js"><link rel="prefetch" href="/assets/js/41.9223bb12.js"><link rel="prefetch" href="/assets/js/42.07ca96a0.js"><link rel="prefetch" href="/assets/js/43.b7dec74e.js"><link rel="prefetch" href="/assets/js/44.11d73b6b.js"><link rel="prefetch" href="/assets/js/45.465aff86.js"><link rel="prefetch" href="/assets/js/46.bbe372ea.js"><link rel="prefetch" href="/assets/js/47.f1307ff1.js"><link rel="prefetch" href="/assets/js/48.42475291.js"><link rel="prefetch" href="/assets/js/49.745b9e09.js"><link rel="prefetch" href="/assets/js/5.9b291583.js"><link rel="prefetch" href="/assets/js/50.a88c5baa.js"><link rel="prefetch" href="/assets/js/51.a69d14c2.js"><link rel="prefetch" href="/assets/js/52.7f0fe0d3.js"><link rel="prefetch" href="/assets/js/53.ad42ee37.js"><link rel="prefetch" href="/assets/js/54.9931c839.js"><link rel="prefetch" href="/assets/js/55.a74fc777.js"><link rel="prefetch" href="/assets/js/56.26f717fb.js"><link rel="prefetch" href="/assets/js/57.5a0a373d.js"><link rel="prefetch" href="/assets/js/58.90e5c727.js"><link rel="prefetch" href="/assets/js/59.a93eca25.js"><link rel="prefetch" href="/assets/js/6.dc063d96.js"><link rel="prefetch" href="/assets/js/60.297876e3.js"><link rel="prefetch" href="/assets/js/61.cf936a1d.js"><link rel="prefetch" href="/assets/js/62.c91c694c.js"><link rel="prefetch" href="/assets/js/63.92cbfe18.js"><link rel="prefetch" href="/assets/js/64.283c56df.js"><link rel="prefetch" href="/assets/js/65.39ed1e97.js"><link rel="prefetch" href="/assets/js/66.b00f2d42.js"><link rel="prefetch" href="/assets/js/67.753037a1.js"><link rel="prefetch" href="/assets/js/68.67de8e9b.js"><link rel="prefetch" href="/assets/js/69.15c9a73e.js"><link rel="prefetch" href="/assets/js/7.ecaff9b4.js"><link rel="prefetch" href="/assets/js/70.21e3630f.js"><link rel="prefetch" href="/assets/js/71.d313acb6.js"><link rel="prefetch" href="/assets/js/72.b87a533b.js"><link rel="prefetch" href="/assets/js/73.26c9c63f.js"><link rel="prefetch" href="/assets/js/74.6e199784.js"><link rel="prefetch" href="/assets/js/75.32817f51.js"><link rel="prefetch" href="/assets/js/76.73594575.js"><link rel="prefetch" href="/assets/js/77.7f325e97.js"><link rel="prefetch" href="/assets/js/78.83a334b8.js"><link rel="prefetch" href="/assets/js/79.74bd0e67.js"><link rel="prefetch" href="/assets/js/8.e8fbb6a4.js"><link rel="prefetch" href="/assets/js/80.d261778f.js"><link rel="prefetch" href="/assets/js/81.2f713290.js"><link rel="prefetch" href="/assets/js/82.e6c59bde.js"><link rel="prefetch" href="/assets/js/83.16cc3405.js"><link rel="prefetch" href="/assets/js/84.b8fe4964.js"><link rel="prefetch" href="/assets/js/85.ee39e590.js"><link rel="prefetch" href="/assets/js/86.d13af18b.js"><link rel="prefetch" href="/assets/js/87.0d182564.js"><link rel="prefetch" href="/assets/js/88.03988432.js"><link rel="prefetch" href="/assets/js/89.b375a9fc.js"><link rel="prefetch" href="/assets/js/9.1ea0a7d0.js"><link rel="prefetch" href="/assets/js/90.df93cfcb.js"><link rel="prefetch" href="/assets/js/91.91249114.js"><link rel="prefetch" href="/assets/js/92.c1acd7b9.js"><link rel="prefetch" href="/assets/js/93.e7f0700e.js"><link rel="prefetch" href="/assets/js/94.5384ccd9.js"><link rel="prefetch" href="/assets/js/95.2eb0ee99.js"><link rel="prefetch" href="/assets/js/96.78b599e4.js"><link rel="prefetch" href="/assets/js/97.09b3b895.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b6a95b11.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Atom</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习资源" class="dropdown-title"><span class="title">学习资源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.imooc.com/article/261756" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端学习路线
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习资源" class="dropdown-title"><span class="title">学习资源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.imooc.com/article/261756" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端学习路线
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>常用工具和库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Font/" class="sidebar-heading clickable"><span>前端知识</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ES6常用方法</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ES6/Array.html" class="sidebar-link">数组方法</a></li><li><a href="/ES6/String.html" class="sidebar-link">字符串的扩展</a></li><li><a href="/ES6/理解this.html" class="sidebar-link">5种情况</a></li><li><a href="/ES6/发布订阅和观察者模式.html" class="sidebar-link">发布订阅模式和观察者模式</a></li><li><a href="/ES6/浏览器和Node.js的事件循环.html" class="sidebar-link">事件循环理解</a></li><li><a href="/ES6/高阶函数之call，apply.html" class="active sidebar-link">实现call，apply，bind,new</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mongodb手册</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Flutter</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工作记录</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h4 id="call函数需求分析"><a href="#call函数需求分析" class="header-anchor">#</a> call函数需求分析</h4> <pre><code>* 改变函数调用的this值
* 可以使用传入的参数当作函数调用的参数
</code></pre> <p>要点：函数内使用this获取当前调用的函数，使用context指定函数的this
使用arguments参数获取传入函数的参数，arguments是一个类数组对象，不能使用数组方法
使用eval拼接字符串调用函数fn</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myCall</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'myCall的this'</span><span class="token punctuation">)</span>
   <span class="token comment">//this总是指向最后一个调用他的对象,myCall也是一个函数，所以这里this可以获取到run函数</span>
   <span class="token comment">//将函数变为传入对象的属性</span>
   context <span class="token operator">=</span> context<span class="token operator">||</span>window
 
   context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
   <span class="token comment">//新增，运行之后在删除</span>
   <span class="token comment">//arguments是类数组对象，可以使用for循环展开</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'接受到的参数arguments'</span><span class="token punctuation">)</span>
   <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'循环内部'</span><span class="token punctuation">)</span>
     <span class="token comment">//arguments[i]就是传过来的参数</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
     args<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'arguments['</span><span class="token operator">+</span>i<span class="token operator">+</span><span class="token string">']'</span><span class="token punctuation">)</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'args的全部参数'</span><span class="token punctuation">)</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token comment">//因为此时你的参数是字符串并不是我们需要的变量</span>
   <span class="token comment">// context.fn(args.join(','))</span>
   <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'context.fn('</span> <span class="token operator">+</span> args <span class="token operator">+</span><span class="token string">')'</span><span class="token punctuation">)</span>
   <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn
   <span class="token keyword">return</span> result
 <span class="token punctuation">}</span>
</code></pre></div><h4 id="apply函数需求分析"><a href="#apply函数需求分析" class="header-anchor">#</a> apply函数需求分析</h4> <pre><code>* 和call类似，但是传入的参数为一个数组类型参数
</code></pre> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myApply</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span>arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 context <span class="token operator">=</span> context<span class="token operator">||</span>window
 <span class="token comment">//此时的this就是要改变this指向的函数</span>
 context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>
 <span class="token keyword">let</span> result
 <span class="token comment">//arr代表传入的参数数组</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>arr<span class="token operator">||</span>arr<span class="token punctuation">.</span>length<span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   result  <span class="token operator">=</span>context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
   <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token comment">//拼接一个字符串</span>
     args<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'arr['</span><span class="token operator">+</span>i<span class="token operator">+</span><span class="token string">']'</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   result <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'context.fn('</span><span class="token operator">+</span>args<span class="token operator">+</span><span class="token string">')'</span><span class="token punctuation">)</span>

 <span class="token punctuation">}</span>
 <span class="token comment">//函数返回值</span>
 context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn
 <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
</code></pre></div><h4 id="bind函数"><a href="#bind函数" class="header-anchor">#</a> bind函数</h4> <pre><code>* bind函数需要返回一个函数调用
* bind函数改变this的指向
* bind函数返回的函数可以当作构造函数调用
* bind函数可以在绑定时传参也可以在调用时传参
* 当bind函数为构造函数调用时，this失效，其他参数
</code></pre> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myBind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    context <span class="token operator">=</span> context <span class="token operator">||</span>window
    context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token comment">//this就是调用的函数</span>
  <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">fBound</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'调用时传参'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
    <span class="token keyword">let</span> bindArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'内部的this值'</span><span class="token punctuation">,</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">fBound</span><span class="token punctuation">)</span>
    <span class="token comment">//如果时构造函数调用则返回this，否则就修改this</span>
    <span class="token keyword">return</span> <span class="token function">_this</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">fBound</span><span class="token operator">?</span><span class="token keyword">this</span> <span class="token punctuation">:</span>context<span class="token punctuation">,</span>args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>bindArgs<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> <span class="token function-variable function">noop</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'this的原型'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
  <span class="token comment">//为了让 fBound 构造的实例能够继承绑定函数的原型中的值</span>
  <span class="token comment">//此时的this是run函数</span>
  noop<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prototype
  fBound<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">noop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> fBound

<span class="token punctuation">}</span>
</code></pre></div><h4 id="new操作符"><a href="#new操作符" class="header-anchor">#</a> new操作符</h4> <pre><code> * new 运算符创建一个用户定义的对象类型的实例或具有构造函数的内置对象类型之一
 * new 操作符可以访问构造函数里面的属性
 * 可以访问到原型上的属性
 * 返回值可以是函数或者对象
</code></pre> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">myNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//新建一个对象</span>
  <span class="token comment">//将arguments得第一个参数作为 构造函数Constructor</span>
  <span class="token keyword">let</span> Constructor <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Constructor<span class="token punctuation">)</span>
  <span class="token keyword">const</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Constructor</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>

  obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token class-name">Constructor</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

  <span class="token comment">//判断函数是否有返回值</span>
  <span class="token keyword">let</span>  ret <span class="token operator">=</span> <span class="token function">Constructor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//判断返回值是函数还是对象</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> ret <span class="token operator">===</span><span class="token string">'function'</span><span class="token operator">||</span><span class="token keyword">typeof</span> ret<span class="token operator">===</span><span class="token string">'object'</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>ret <span class="token operator">!==</span><span class="token keyword">null</span><span class="token operator">?</span> ret<span class="token punctuation">:</span>obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/ES6/浏览器和Node.js的事件循环.html" class="prev">事件循环理解</a></span> <span class="next"><a href="/Mongodb/mongodb.html">Mongodb和Mongoose的使用</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7506ff96.js" defer></script><script src="/assets/js/2.e528d5f4.js" defer></script><script src="/assets/js/14.fae9289b.js" defer></script>
  </body>
</html>
