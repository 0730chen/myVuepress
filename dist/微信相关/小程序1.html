<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小程序基础开发 | Atom</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="敲就硬敲">
    <link rel="preload" href="/assets/css/0.styles.edf51690.css" as="style"><link rel="preload" href="/assets/js/app.de8a721d.js" as="script"><link rel="preload" href="/assets/js/3.7510b978.js" as="script"><link rel="preload" href="/assets/js/1.c4dab98e.js" as="script"><link rel="preload" href="/assets/js/126.83880fa0.js" as="script"><link rel="prefetch" href="/assets/js/10.1e33f497.js"><link rel="prefetch" href="/assets/js/100.17a0d246.js"><link rel="prefetch" href="/assets/js/101.30d9f7fc.js"><link rel="prefetch" href="/assets/js/102.d57b285e.js"><link rel="prefetch" href="/assets/js/103.7d6f20ca.js"><link rel="prefetch" href="/assets/js/104.a0a97498.js"><link rel="prefetch" href="/assets/js/105.7db12137.js"><link rel="prefetch" href="/assets/js/106.9f5f02a2.js"><link rel="prefetch" href="/assets/js/107.589d08f7.js"><link rel="prefetch" href="/assets/js/108.07fa2d42.js"><link rel="prefetch" href="/assets/js/109.39403567.js"><link rel="prefetch" href="/assets/js/11.f160bd70.js"><link rel="prefetch" href="/assets/js/110.dc40f8e1.js"><link rel="prefetch" href="/assets/js/111.4ba44348.js"><link rel="prefetch" href="/assets/js/112.21409b9a.js"><link rel="prefetch" href="/assets/js/113.d6e7ae88.js"><link rel="prefetch" href="/assets/js/114.831e64fd.js"><link rel="prefetch" href="/assets/js/115.842620fe.js"><link rel="prefetch" href="/assets/js/116.d36fd107.js"><link rel="prefetch" href="/assets/js/117.b672a34b.js"><link rel="prefetch" href="/assets/js/118.62ae722a.js"><link rel="prefetch" href="/assets/js/119.301d8ae5.js"><link rel="prefetch" href="/assets/js/12.7d9a5670.js"><link rel="prefetch" href="/assets/js/120.c8514ec1.js"><link rel="prefetch" href="/assets/js/121.1a73fdaf.js"><link rel="prefetch" href="/assets/js/122.9146e9e3.js"><link rel="prefetch" href="/assets/js/123.d17b96a2.js"><link rel="prefetch" href="/assets/js/124.f4ecd5da.js"><link rel="prefetch" href="/assets/js/125.081cb375.js"><link rel="prefetch" href="/assets/js/127.f01d69b7.js"><link rel="prefetch" href="/assets/js/128.ba3d6949.js"><link rel="prefetch" href="/assets/js/129.d899e9da.js"><link rel="prefetch" href="/assets/js/13.159390bd.js"><link rel="prefetch" href="/assets/js/130.3ae4a913.js"><link rel="prefetch" href="/assets/js/131.a3026d91.js"><link rel="prefetch" href="/assets/js/132.16caaad8.js"><link rel="prefetch" href="/assets/js/133.11115d79.js"><link rel="prefetch" href="/assets/js/14.8d02f504.js"><link rel="prefetch" href="/assets/js/15.8fe677dd.js"><link rel="prefetch" href="/assets/js/16.7f913cc2.js"><link rel="prefetch" href="/assets/js/17.69649cf3.js"><link rel="prefetch" href="/assets/js/18.53ca9cc9.js"><link rel="prefetch" href="/assets/js/19.7a1f0f2a.js"><link rel="prefetch" href="/assets/js/20.74f6108c.js"><link rel="prefetch" href="/assets/js/21.240adc92.js"><link rel="prefetch" href="/assets/js/22.a15f166b.js"><link rel="prefetch" href="/assets/js/23.b168bb94.js"><link rel="prefetch" href="/assets/js/24.14e0e8a6.js"><link rel="prefetch" href="/assets/js/25.56d3d124.js"><link rel="prefetch" href="/assets/js/26.f5476c37.js"><link rel="prefetch" href="/assets/js/27.8b9ff013.js"><link rel="prefetch" href="/assets/js/28.c3fe0867.js"><link rel="prefetch" href="/assets/js/29.b585f1a0.js"><link rel="prefetch" href="/assets/js/30.62834a80.js"><link rel="prefetch" href="/assets/js/31.cc563917.js"><link rel="prefetch" href="/assets/js/32.c2abae39.js"><link rel="prefetch" href="/assets/js/33.82ad8a8f.js"><link rel="prefetch" href="/assets/js/34.cec5a769.js"><link rel="prefetch" href="/assets/js/35.ea6f7495.js"><link rel="prefetch" href="/assets/js/36.0ed4540d.js"><link rel="prefetch" href="/assets/js/37.6beb8e59.js"><link rel="prefetch" href="/assets/js/38.a455bffb.js"><link rel="prefetch" href="/assets/js/39.098580db.js"><link rel="prefetch" href="/assets/js/4.6cdaa6b6.js"><link rel="prefetch" href="/assets/js/40.19eb2891.js"><link rel="prefetch" href="/assets/js/41.812f72ce.js"><link rel="prefetch" href="/assets/js/42.967561a6.js"><link rel="prefetch" href="/assets/js/43.75866ac6.js"><link rel="prefetch" href="/assets/js/44.3921181f.js"><link rel="prefetch" href="/assets/js/45.3b2df3c3.js"><link rel="prefetch" href="/assets/js/46.54c8ab22.js"><link rel="prefetch" href="/assets/js/47.f93ceabd.js"><link rel="prefetch" href="/assets/js/48.61848a60.js"><link rel="prefetch" href="/assets/js/49.41160e5d.js"><link rel="prefetch" href="/assets/js/5.84abc1cc.js"><link rel="prefetch" href="/assets/js/50.4442b38f.js"><link rel="prefetch" href="/assets/js/51.440babb9.js"><link rel="prefetch" href="/assets/js/52.8f8c408d.js"><link rel="prefetch" href="/assets/js/53.4b0b1996.js"><link rel="prefetch" href="/assets/js/54.1272c623.js"><link rel="prefetch" href="/assets/js/55.6bdf15fc.js"><link rel="prefetch" href="/assets/js/56.59c39bf6.js"><link rel="prefetch" href="/assets/js/57.cae9d57a.js"><link rel="prefetch" href="/assets/js/58.146e3bdf.js"><link rel="prefetch" href="/assets/js/59.6568c5b0.js"><link rel="prefetch" href="/assets/js/6.0eabcf21.js"><link rel="prefetch" href="/assets/js/60.d15bd98c.js"><link rel="prefetch" href="/assets/js/61.62adc960.js"><link rel="prefetch" href="/assets/js/62.8498d286.js"><link rel="prefetch" href="/assets/js/63.75bc44a5.js"><link rel="prefetch" href="/assets/js/64.3053bd78.js"><link rel="prefetch" href="/assets/js/65.1a1c8739.js"><link rel="prefetch" href="/assets/js/66.412ed84a.js"><link rel="prefetch" href="/assets/js/67.33b4b911.js"><link rel="prefetch" href="/assets/js/68.66652582.js"><link rel="prefetch" href="/assets/js/69.bfc82d09.js"><link rel="prefetch" href="/assets/js/7.9685f570.js"><link rel="prefetch" href="/assets/js/70.012d89de.js"><link rel="prefetch" href="/assets/js/71.7668367a.js"><link rel="prefetch" href="/assets/js/72.97483824.js"><link rel="prefetch" href="/assets/js/73.64a16b88.js"><link rel="prefetch" href="/assets/js/74.d41a965b.js"><link rel="prefetch" href="/assets/js/75.bed02333.js"><link rel="prefetch" href="/assets/js/76.65a3e54d.js"><link rel="prefetch" href="/assets/js/77.4ab45783.js"><link rel="prefetch" href="/assets/js/78.ebbb73b8.js"><link rel="prefetch" href="/assets/js/79.81e32186.js"><link rel="prefetch" href="/assets/js/8.1153fce0.js"><link rel="prefetch" href="/assets/js/80.37decb20.js"><link rel="prefetch" href="/assets/js/81.ff2e7f9a.js"><link rel="prefetch" href="/assets/js/82.d1dc390f.js"><link rel="prefetch" href="/assets/js/83.454e5d81.js"><link rel="prefetch" href="/assets/js/84.36b5257b.js"><link rel="prefetch" href="/assets/js/85.d7effc0b.js"><link rel="prefetch" href="/assets/js/86.2ec91f8d.js"><link rel="prefetch" href="/assets/js/87.b3455f38.js"><link rel="prefetch" href="/assets/js/88.65ed39af.js"><link rel="prefetch" href="/assets/js/89.da275229.js"><link rel="prefetch" href="/assets/js/9.dd6bf762.js"><link rel="prefetch" href="/assets/js/90.ea3756d0.js"><link rel="prefetch" href="/assets/js/91.3e038232.js"><link rel="prefetch" href="/assets/js/92.648ac862.js"><link rel="prefetch" href="/assets/js/93.84902b8d.js"><link rel="prefetch" href="/assets/js/94.2c2182e0.js"><link rel="prefetch" href="/assets/js/95.36f6520c.js"><link rel="prefetch" href="/assets/js/96.13144aec.js"><link rel="prefetch" href="/assets/js/97.5d6dfc90.js"><link rel="prefetch" href="/assets/js/98.df2d9eff.js"><link rel="prefetch" href="/assets/js/99.3f9569b9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.edf51690.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-dad8a512><div data-v-dad8a512><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-dad8a512 data-v-dad8a512><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>Atom</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>atom</span>
            
          <span data-v-64685f0e>2019 - </span>
          2020
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="./images/avator.jpg" alt="Atom" class="logo"> <span class="site-name">Atom</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      学习资源
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/%E5%BE%AE%E4%BF%A1%E7%9B%B8%E5%85%B3/.html" class="nav-link"><i class="iconfont undefined"></i>
  前端学习路线
</a></li></ul></div></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-ca798c94 data-v-dad8a512><img src="./images/avator.jpg" alt="author-avatar" class="personal-img" data-v-ca798c94> <h3 class="name" data-v-ca798c94>
    atom
  </h3> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>62</h3> <h6 data-v-ca798c94>Article</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>86</h3> <h6 data-v-ca798c94>Tag</h6></div></div> <hr data-v-ca798c94></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      学习资源
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/%E5%BE%AE%E4%BF%A1%E7%9B%B8%E5%85%B3/.html" class="nav-link"><i class="iconfont undefined"></i>
  前端学习路线
</a></li></ul></div></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>常用工具和库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/Font/" class="sidebar-heading clickable"><span>前端知识</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ES6常用方法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>正则系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>微信相关</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/微信相关/微信公众号开发1.html" class="sidebar-link">微信开发指南</a></li><li><a href="/微信相关/小程序1.html" class="active sidebar-link">小程序基础开发</a></li><li><a href="/微信相关/小程序云开发.html" class="sidebar-link">微信小程序云开发</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mongodb手册</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Flutter</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工作记录</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>goLang</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>python</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>小程序基础开发</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>atom</span>
            
          <span data-v-64685f0e>2019 - </span>
          2020
        </a></span></div></div> <div data-v-dad8a512><main class="page" style="padding-right:0;"><div class="page-title" style="display:none;"><h1>小程序基础开发</h1> <div data-v-3b7f5bdf><i class="iconfont reco-account" data-v-3b7f5bdf><span data-v-3b7f5bdf>atom</span></i> <i class="iconfont reco-date" data-v-3b7f5bdf><span data-v-3b7f5bdf>2020-08-16</span></i> <!----> <i class="iconfont reco-tag tags" data-v-3b7f5bdf><span class="tag-item" data-v-3b7f5bdf>微信</span><span class="tag-item" data-v-3b7f5bdf>小程序</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h4 id="微信小程序"><a href="#微信小程序" class="header-anchor">#</a> 微信小程序</h4> <h5 id="目录"><a href="#目录" class="header-anchor">#</a> 目录</h5> <table><thead><tr><th>文件名</th> <th>含义</th></tr></thead> <tbody><tr><td>page</td> <td>页面相关的内容,一个 page 的文件就是一个页面</td></tr> <tr><td>index.js</td> <td>一个 page 文件包含一个[name].js,主要是页面的逻辑代码</td></tr> <tr><td>index.json</td> <td>一个 page 包含一个[name].json，主要是包含页面的配置文件，例如标题，引入组件等等</td></tr> <tr><td>index.wxml</td> <td>一个 page 包含一个[name].wxml,主要是包含页面的组成内容，相当于 index.html</td></tr> <tr><td>index.wxss</td> <td>一个 page 包含一个[name].wxss，主要是项目的总样式，相当于 css</td></tr> <tr><td>untils</td> <td>工具相关的函数</td></tr> <tr><td>app.js</td> <td>项目的总的 js</td></tr> <tr><td>app.json</td> <td>项目总的配置，主要用于配置标题和导航</td></tr></tbody></table> <h5 id="配置文件详情"><a href="#配置文件详情" class="header-anchor">#</a> 配置文件详情</h5> <ul><li>project.config.json</li></ul> <div class="language-json extra-class"><pre class="language-json"><code>setting：<span class="token punctuation">{</span>

urlCheck 是否检测安全的域名

es6 是否把 es6 转 es5

postcss 是否把 css 样式自动补全

minified 是否压缩

<span class="token punctuation">}</span>

</code></pre></div><h5 id="语法详解"><a href="#语法详解" class="header-anchor">#</a> 语法详解</h5> <ul><li>循环</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{list}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>循环参数改变</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{list}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for-index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>in<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>条件渲染
类似与 v-if</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{isLogin}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>else</span><span class="token punctuation">&gt;</span></span>已登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>条件显示
类似于 v-show</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{login}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>双向绑定
微信小程序有简易的双向绑定</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{name}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>绑定事件</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>eventName<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击事件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">eventName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">&quot;我是一个点击事件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="wxss-微信小程序的样式语法"><a href="#wxss-微信小程序的样式语法" class="header-anchor">#</a> wxss 微信小程序的样式语法</h4> <p>WXSS 具有 CSS 大部分特性。同时为了更适合开发微信小程序，WXSS 对 CSS 进行了扩充以及修改。</p> <ul><li>rpx（responsive pixel）: 可以根据屏幕宽度进行自适应。规定屏幕宽为 750rpx。如在 iPhone6 上，屏幕宽度为 375px，共有 750 个物理像素，则 750rpx = 375px = 750 物理像素，1rpx = 0.5px = 1 物理像素。</li></ul> <table><thead><tr><th>设备</th> <th>rpx 换算 px(屏幕宽度/750)</th> <th>px 换算 rpx(750/屏幕宽度)</th></tr></thead> <tbody><tr><td>iPhone5</td> <td>1rpx=0.42px</td> <td>1px=2.34rpx</td></tr> <tr><td>iPhone6</td> <td>1rpx = 0.5px</td> <td>1px=2rpx</td></tr> <tr><td>iPhone6 Plus</td> <td>1px = 0.552rpx</td> <td>1px = 1.811rpx</td></tr></tbody></table> <h4 id="wxsapi"><a href="#wxsapi" class="header-anchor">#</a> wxsAPI</h4> <ul><li>绑定事件</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clickName<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;哈哈&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">clickName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>注意事项
在微信小程序中，直接改变变量的值是页面是无法同步渲染的，这个和 React 相类似</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;哈哈&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">clickName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">;</span> <span class="token comment">//这样赋值是无法更新到页面上的，你会发现值已经改变，内容还是之前的内容</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>setData 函数</li></ul> <p>setData 函数是微信小程序用来改变页面变量内容的方法</p> <p>setData()接受一个对象,key 是你要改变的变量名，value 是新的值</p> <ul><li>小程序中修改 data 中的数组某一项值,使用数组和字符串拼接方式</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> index <span class="token operator">=</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>index<span class="token punctuation">;</span>
<span class="token keyword">let</span> value <span class="token operator">=</span> event<span class="token punctuation">.</span>detail<span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">questionList[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">].value</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token operator">:</span> value<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>阻止事件冒泡</li></ul> <p>将 bindtap 绑定的方式变成 catchtap</p> <ul><li>比较常见的小程序 UI 组件库</li></ul> <table><thead><tr><th>第三方库</th> <th>介绍</th> <th>地址</th></tr></thead> <tbody><tr><td>Vant Weapp</td> <td>由有赞打造的一款小程序 UI 组件库</td> <td><a href="https://vant-contrib.gitee.io/vant-weapp/#/intro" target="_blank" rel="noopener noreferrer">地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td></tr> <tr><td>Taro UI</td> <td>一款由京东打造的移动端 UI 组件库</td> <td><a href="https://taro-ui.jd.com/#/docs/introduction" target="_blank" rel="noopener noreferrer">地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td></tr> <tr><td>WeUI</td> <td>微信原生的 UI 组件库</td> <td><a href="https://weui.io/" target="_blank" rel="noopener noreferrer">地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td></tr> <tr><td>iView Weapp</td> <td>iView 团队开发的高质量的 UI 组件库</td> <td><a href="https://weapp.iviewui.com/docs/guide/start" target="_blank" rel="noopener noreferrer">地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td></tr></tbody></table> <h4 id="自定义组件"><a href="#自定义组件" class="header-anchor">#</a> 自定义组件</h4> <p>微信小程序目录中 page 页面是页面文件,他的 js 文件是一个 page 对象的构造函数</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//函数可以直接写</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>components 页面可以建立一些组件，主要是用来进行复用使用的代码</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>


  <span class="token comment">//接受外部传入的值</span>
  properties<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//组件本身的值</span>
  data：<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//组件中的方法值</span>
  methods<span class="token operator">:</span><span class="token punctuation">{</span>
       <span class="token comment">// 内部方法建议以下划线开头</span>
    <span class="token function-variable function">_myPrivateMethod</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// 这里将 data.A[0].B 设为 'myPrivateData'</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">'A[0].B'</span><span class="token operator">:</span> <span class="token string">'myPrivateData'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//小程序生命周期</span>
    lifetimes<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 生命周期函数，可以为函数，或一个在methods段中定义的方法名</span>
    <span class="token function-variable function">attached</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">moved</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">detached</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

    pageLifetimes<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 组件所在页面的生命周期函数</span>
    <span class="token function-variable function">show</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">hide</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">resize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h4 id="父组件异步方式传参给子组件"><a href="#父组件异步方式传参给子组件" class="header-anchor">#</a> 父组件异步方式传参给子组件</h4> <ul><li>子组件使用 properties 接受父组件的传参,无法接受异步参数,因子子组件的还未等到父组件获得值，组件就已经加载了</li> <li>可以使用 observer 模式，监听这个对象对他赋值</li> <li>不推荐在 observer 中改变 properties 值，会造成无限循环</li> <li>推荐使用组件内的 data 数据作为展示，监听 patient 的数据变化，给 data 赋值</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  properites<span class="token operator">:</span> <span class="token punctuation">{</span>
    patient<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Object<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  observers<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">patient</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        patientMessage<span class="token operator">:</span> res<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="路由参数传递方法"><a href="#路由参数传递方法" class="header-anchor">#</a> 路由参数传递方法</h4> <p>在小程序中的路由跳转</p> <p>通常我们可以使用 url 拼接参数的方式进行路由传参</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//第一种，路由传值</span>
wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">'/url?key=&quot;word&quot;'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>url 传参长度限制解决方法,patientMessage 必须是字符串,如果是对象则需要 JSON.stringify()进行转换</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//参数序列号之后使用encodeURLcomponent编码</span>
<span class="token keyword">let</span> url <span class="token operator">=</span>  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../editorPatient/editorPatient?message=</span><span class="token template-punctuation string">`</span></span><span class="token operator">+</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>patientMessage<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token comment">//在onload页面解码穿过的参数</span>
<span class="token function">decodeURIComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>//第二种方式，事件传值</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">,</span>
  events<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 为指定事件添加一个监听器，获取被打开页面传送到当前页面的数据</span>
    <span class="token function-variable function">acceptDataFromOpenedPage</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">someEvent</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过eventChannel向被打开页面传送数据，触发一个事件，传递一个数据</span>
    res<span class="token punctuation">.</span>eventChannel<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在目标页面</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//第一种，路由传值</span>
<span class="token function">page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">//第一种，路由传值</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">option</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span>key<span class="token punctuation">}</span> <span class="token operator">=</span> option<span class="token punctuation">.</span>query
  <span class="token punctuation">}</span>，
  <span class="token comment">//第二种，事件通信</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">option</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">//建立一个事件传播对象</span>
    <span class="token keyword">const</span> eventChannel <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getOpenerEventChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    eventChannel<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'acceptDataFromOpenedPage'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>data<span class="token operator">:</span> <span class="token string">'test'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    eventChannel<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'someEvent'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>data<span class="token operator">:</span> <span class="token string">'test'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//持续监听上一页的事件</span>
    eventChannel<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h4 id="发起请求"><a href="#发起请求" class="header-anchor">#</a> 发起请求</h4> <ul><li>wx.request</li> <li>最终发送给服务器的数据是 String 类型，如果传入的 data 不是 String 类型，会被转换成 String 。</li></ul> <h5 id="转换规则如下"><a href="#转换规则如下" class="header-anchor">#</a> 转换规则如下</h5> <ul><li>对于 GET 方法的数据，会将数据转换成 query string（encodeURIComponent(k)=encodeURIComponent(v)&amp;encodeURIComponent(k)=encodeURIComponent(v)...）</li> <li>对于 POST 方法且 header['content-type'] 为 application/json 的数据，会对数据进行 JSON 序列化</li> <li>对于 POST/PUT 方法且 header['content-type'] 为 application/x-www-form-urlencoded 的数据，会将数据转换成 query string （encodeURIComponent(k)=encodeURIComponent(v)&amp;encodeURIComponent(k)=encodeURIComponent(v)...）</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&quot;test.php&quot;</span><span class="token punctuation">,</span> <span class="token comment">//仅为示例，并非真实的接口地址</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    x<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    y<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  header<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;content-type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 默认值</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>domain<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/tcm-applet/user/create</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  method<span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
  header<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;content-type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/x-www-form-urlencoded&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> patientMessage<span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token operator">:</span> error<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="图片上传踩坑"><a href="#图片上传踩坑" class="header-anchor">#</a> 图片上传踩坑</h4> <p>首先先调用选择图片的方法，然后使用 wx.uploadFile 上传图片,name 参数就是你图片接口中的图片数据存放的参数，formData 可以放置其他 formdata 参数，filePath 时本地生成的图片路径，
在调用 wx.chooseImage 就生成的</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>wx<span class="token punctuation">.</span><span class="token function">chooseImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> tempFilePaths <span class="token operator">=</span> res<span class="token punctuation">.</span>tempFilePaths<span class="token punctuation">;</span>
    wx<span class="token punctuation">.</span><span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> <span class="token string">&quot;https://example.weixin.qq.com/upload&quot;</span><span class="token punctuation">,</span> <span class="token comment">//仅为示例，非真实的接口地址</span>
      filePath<span class="token operator">:</span> tempFilePaths<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">,</span>
      formData<span class="token operator">:</span> <span class="token punctuation">{</span>
        user<span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
        <span class="token comment">//do something</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="wxs-语法"><a href="#wxs-语法" class="header-anchor">#</a> wxs 语法</h4> <p>当我们需要对页面中的数据进行展示处理，需要用到函数，vue 中可以直接引入定义好的函数进行运行计算</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">queryString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    <span class="token function">queryString</span><span class="token punctuation">(</span>需要处理的参数<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在小程序中这样是不支持的,使用 wxs 语法在 wxml 页面中引入函数</p> <ul><li>wxs 代码可以写在 wxml 页面中的标签中也可以写在一个以.wxs 结尾的文件中</li></ul> <h5 id="基本语法"><a href="#基本语法" class="header-anchor">#</a> 基本语法</h5> <p>变量以 var 声明,不支持 let const，声明后需要使用 module.exports 导出，这样就可以在其他页面中使用</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token string">&quot;'hello world' from comm.wxs&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> d<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  foo<span class="token operator">:</span> foo<span class="token punctuation">,</span>
  bar<span class="token operator">:</span> bar<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>每一个 wxs 对象都有一个 modules 对象</li> <li>可以使用 require 引入其他 wxs 文件的函数</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>引入的模块名称，必填<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>引入的文件路径<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wxs</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="wxs-的函数定义"><a href="#wxs-的函数定义" class="header-anchor">#</a> wxs 的函数定义</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//方法 1</span>
<span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//方法 2</span>
<span class="token keyword">var</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>wxs 中使用 Date 对象,此时不能使用 new Date()获取 date 对象</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回当前时间对象</span>

date <span class="token operator">=</span> <span class="token function">getDate</span><span class="token punctuation">(</span><span class="token number">1500000000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Fri Jul 14 2017 10:40:00 GMT+0800 (中国标准时间)</span>
date <span class="token operator">=</span> <span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">&quot;2017-7-14&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Fri Jul 14 2017 00:00:00 GMT+0800 (中国标准时间)</span>
date <span class="token operator">=</span> <span class="token function">getDate</span><span class="token punctuation">(</span><span class="token number">2017</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Fri Jul 14 2017 10:40:00 GMT+0800 (中国标准时间)</span>
</code></pre></div><ul><li>wxs 中使用正则</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">getRegExp</span><span class="token punctuation">(</span>pattern<span class="token punctuation">[</span><span class="token punctuation">,</span> flags<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">getRegExp</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;img&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span> <span class="token operator">===</span> a<span class="token punctuation">.</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token boolean">true</span> <span class="token operator">===</span> a<span class="token punctuation">.</span>global<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token boolean">true</span> <span class="token operator">===</span> a<span class="token punctuation">.</span>ignoreCase<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token boolean">true</span> <span class="token operator">===</span> a<span class="token punctuation">.</span>multiline<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="小程序安装-npm-包后构建失败"><a href="#小程序安装-npm-包后构建失败" class="header-anchor">#</a> 小程序安装 npm 包后构建失败</h4> <ul><li>首先需要卸载之前安装的 npm 包</li> <li>npm cache clean --force 清理缓存</li> <li>删除生成的 node_modules 和其他文件</li> <li>删除 lock.json 文件</li> <li>重新安装正常的组件库包，点击构建</li> <li>重新启动微信开发者工具</li></ul> <h4 id="vant-image-引入本地图片和弹窗组件使用"><a href="#vant-image-引入本地图片和弹窗组件使用" class="header-anchor">#</a> vant-image 引入本地图片和弹窗组件使用</h4> <ul><li>image 文件需要和 pages 文件夹在同一目录下</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/image/xxx.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-image</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>弹窗组件使用(Toast 组件也是类似的)，需要自定义组件，类似与在弹窗中添加图片内容，则只能使用组件调用形式</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//从构建好的包引入组件</span>
<span class="token keyword">const</span> Dialog <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../../miniprogram_npm/@vant/weapp/dialog/dialog&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Dialog<span class="token punctuation">.</span>default
  <span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    context<span class="token operator">:</span> that<span class="token punctuation">,</span>
    selector<span class="token operator">:</span> <span class="token string">&quot;#van-dialog&quot;</span><span class="token punctuation">,</span>
    title<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    message<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>domain<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/tcm-applet/user?id=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      method<span class="token operator">:</span> <span class="token string">&quot;DELETE&quot;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Toast<span class="token punctuation">.</span>default<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          context<span class="token operator">:</span> that<span class="token punctuation">,</span>
          message<span class="token operator">:</span> <span class="token string">&quot;删除成功&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getNewPatientList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        Toast<span class="token punctuation">.</span>default<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          context<span class="token operator">:</span> that<span class="token punctuation">,</span>
          message<span class="token operator">:</span> error<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Toast<span class="token punctuation">.</span>default<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      context<span class="token operator">:</span> that<span class="token punctuation">,</span>
      message<span class="token operator">:</span> <span class="token string">&quot;已取消&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>三目运算符实现动态 class</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-dialog</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>van-dialog<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-dialog</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{show?<span class="token punctuation">'</span>class1<span class="token punctuation">'</span>:<span class="token punctuation">'</span>class2<span class="token punctuation">'</span>}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="小程序-wx-request-报错"><a href="#小程序-wx-request-报错" class="header-anchor">#</a> 小程序 wx.request 报错</h4> <p>可以在工具设置中将代理关掉，基本使用库选择到占比较多的库</p> <h4 id="微信小程序中获取用户的-openid"><a href="#微信小程序中获取用户的-openid" class="header-anchor">#</a> 微信小程序中获取用户的 openid</h4> <p>在小程序端，用户需要进行授权,现在授权必须要求用户点击按钮触发</p> <ul><li>wx.getSetting 接口，返回值是小程序已经向用户请求过的权限</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 获取用户信息</span>
    wx<span class="token punctuation">.</span><span class="token function">getSetting</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//判断用户是否允许这个权限</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>authSetting<span class="token punctuation">[</span><span class="token string">'scope.userInfo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 已经授权，可以直接调用 getUserInfo 获取头像昵称，不会弹框</span>
          wx<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
              <span class="token comment">// 可以将 res 发送给后台解码出 unionId</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userInfo <span class="token operator">=</span> res<span class="token punctuation">.</span>userInfo

              <span class="token comment">// 由于 getUserInfo 是网络请求，可能会在 Page.onLoad 之后才返回</span>
              <span class="token comment">// 所以此处加入 callback 以防止这种情况</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userInfoReadyCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">userInfoReadyCallback</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>授权登陆设置 button 组件的类型 open-type='getUserInfo'</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>login<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{canIUse}}<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getUserInfo<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">bindgetuserinfo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bindGetUserInfo<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>login<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
  授权登录
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>
  <span class="token function">bindGetUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          userMessage<span class="token operator">:</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>rawData<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            <span class="token comment">// 发送 res.code 到后台换取 openId, sessionKey, unionId</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          login<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h4 id="vant-组件"><a href="#vant-组件" class="header-anchor">#</a> vant 组件</h4> <ul><li><p>使用时间选择器需要配合弹出层使用</p></li> <li><p>van-group-cell 组合,比较使用于页面展示信息，用户界面展示跳转，或者选择样式,van-group-cell 包裹的 van-cell 默认会有 border，</p></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>van<span class="token operator">-</span>cell center bindtap<span class="token operator">=</span><span class="token string">&quot;selectDate&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span> is<span class="token operator">-</span>link title<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">&quot;90px&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>view slot<span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>年龄<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>picker
    mode<span class="token operator">=</span><span class="token string">&quot;date&quot;</span>
    value<span class="token operator">=</span><span class="token string">&quot;{{date}}&quot;</span>
    start<span class="token operator">=</span><span class="token string">&quot;1930-01-01&quot;</span>
    end<span class="token operator">=</span><span class="token string">&quot;2020-7-31&quot;</span>
    bindchange<span class="token operator">=</span><span class="token string">&quot;bindDateChange&quot;</span>
  <span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;picker&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>text wx<span class="token operator">:</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;{{age.length===0}}&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;empty-age&quot;</span><span class="token operator">&gt;</span>
        年龄<span class="token punctuation">{</span><span class="token string">&quot; &quot;</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token string">&quot; &quot;</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;age&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> age <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>picker<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>cell<span class="token operator">&gt;</span>
</code></pre></div><p>van-cell 的里面的 picker 选择器必须要有一个值（默认值）才可以触发，如果没有值是无法触发微信原生选择器</p> <p>van-cell 可以用来做表单，表单的必填字段的*可以用 required 表示</p> <ul><li>van-cell 的插槽</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>van<span class="token operator">-</span>cell value<span class="token operator">=</span><span class="token string">&quot;内容&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;shop-o&quot;</span> is<span class="token operator">-</span>link<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>view slot<span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;van-cell-text&quot;</span><span class="token operator">&gt;</span>单元格<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>van<span class="token operator">-</span>tag type<span class="token operator">=</span><span class="token string">&quot;danger&quot;</span><span class="token operator">&gt;</span>标签<span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>tag<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>cell<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>van<span class="token operator">-</span>cell title<span class="token operator">=</span><span class="token string">&quot;单元格&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>van<span class="token operator">-</span>icon slot<span class="token operator">=</span><span class="token string">&quot;right-icon&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;search&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;custom-icon&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>cell<span class="token operator">&gt;</span>

</code></pre></div><p>van-tab 的内部滚动样式不好用</p> <p>使用微信小程序的 scroll-view 将需要滚动的样式组件包裹</p> <ul><li><p>scroll-view 的属性值，在滚动页面使用弹窗时，会产生样式穿透，弹窗出现后页面依然可以滚动</p></li> <li><p>使用 scroll-view 样式去控制滚动，当页面弹窗出现时，设置 scroll-x 或 scroll-y 禁止滚动即可</p></li> <li><p>监听事件 catch:touchmove=&quot;stopMove&quot; stopMove return false</p></li> <li><p>scroll-x false</p></li> <li><p>scroll-y false</p></li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scroll-view</span>
  <span class="token attr-name">scroll-y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name">
  <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">height</span><span class="token punctuation">:</span> 300rpx<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">bindscrolltoupper</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>upper<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">bindscrolltolower</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lower<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">bindscroll</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scroll<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">scroll-into-view</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{toView}}<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">scroll-top</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{scrollTop}}<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>demo1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scroll-view-item demo-text-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>demo2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scroll-view-item demo-text-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>demo3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scroll-view-item demo-text-3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scroll-view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>使用 van-cell 实现页面的左右布局</p> <h4 id="van-weapp-覆盖样式"><a href="#van-weapp-覆盖样式" class="header-anchor">#</a> van-weapp 覆盖样式</h4> <ul><li>在 Page 页面中可以直接覆盖样式</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>主要按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* page.wxss */</span>
<span class="token selector">.van-button--primary</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> pink<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>在自定义组件中需要设置属性覆盖样式</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  options<span class="token operator">:</span> <span class="token punctuation">{</span>
    styleIsolation<span class="token operator">:</span> <span class="token string">&quot;shared&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>使用外部样式类时，需要使用!important 强制应用样式</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.cell-title</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> pink <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 20px <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.cell-value</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> green <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 12px <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="组件覆盖"><a href="#组件覆盖" class="header-anchor">#</a> 组件覆盖</h4> <ul><li>z-index 和组件层级，当使用 vant 的 dialog 组件，实现弹窗功能时，如果页面有 scroll-view 组件和 icon 组件，则弹窗出现时，icon 组件依然可以被点击，着是由于组件所处的层级不同，所以 dialog 的遮罩层无法覆盖 icon 组件</li></ul> <h4 id="vant-cell-组件的点击效果"><a href="#vant-cell-组件的点击效果" class="header-anchor">#</a> vant-cell 组件的点击效果</h4> <ul><li><p>当 cell 组件里面嵌套 cell 组件时，开启 cell 的点击效果，外部的 cell 会触发，但是内部的 cell 没有效果，会有色差</p></li> <li><p>可以将内容写在一个 cell 中,使用插槽，将多余的内容放在 label 中，当他的盒模型过大时，可以使用,就多余的内容隐藏</p></li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.label</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*隐藏文本方式*/</span>

<span class="token selector">.text</span> <span class="token punctuation">{</span>
  <span class="token property">　overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
  <span class="token property">　text-overflow</span><span class="token punctuation">:</span> ellipsis<span class="token punctuation">;</span>
  <span class="token property">　white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.text2</span><span class="token punctuation">{</span>
  <span class="token property">text-overflow</span><span class="token punctuation">:</span> -o-ellipsis-lastline<span class="token punctuation">;</span>
<span class="token property">　overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token property">　text-overflow</span><span class="token punctuation">:</span> ellipsis<span class="token punctuation">;</span>
<span class="token property">　display</span><span class="token punctuation">:</span> -webkit-box<span class="token punctuation">;</span>
<span class="token property">　-webkit-line-clamp</span><span class="token punctuation">:</span> 3<span class="token punctuation">;</span> //行数需设置
  <span class="token property">line-clamp</span><span class="token punctuation">:</span> 3<span class="token punctuation">;</span>
<span class="token property">　-webkit-box-orient</span><span class="token punctuation">:</span> vertical<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="小程序层级问题踩坑"><a href="#小程序层级问题踩坑" class="header-anchor">#</a> 小程序层级问题踩坑</h4> <p>vant组件和tabs组件的层级遮盖问题，当你在自定义组件中使用vant-dialog组件时，在父组件中引用这个组件，并且父组件中有一个icon，和你的子组件是同级的，此时你的子组件跳出的dialog的遮罩层无法遮盖这个icon</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre-form</span> <span class="token attr-name"><span class="token namespace">bind:</span>doctor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>doctor<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>vant-dialog</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre-form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>vant-cion</span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>此时两个是同一级的，所以,内部子组件的dialog组件的遮罩层无法遮盖父组件内部的icon</p> <p>在小程序中如果涉及到弹窗和浮层的层级问题，建议将dialog弹窗放在父组件中这样dialog产生的遮罩层不会被穿透</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//父组件</span>
<span class="token function">doctor</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//{res.detail {xxx:'xxx'}}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//子组件</span>
<span class="token function">doctor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//第二个参数就是穿过去的参数</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">triggerEvent</span><span class="token punctuation">(</span><span class="token string">'doctor'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>xxx<span class="token operator">:</span><span class="token string">'xxx'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//</span>
</code></pre></div><h4 id="小程序的分享事件"><a href="#小程序的分享事件" class="header-anchor">#</a> 小程序的分享事件</h4> <p>当页面触发了右上角的分享或者使用button类型的分享时触发</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
  <span class="token function-variable function">onShareAppMessage</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//form是来源，是button触发还是右上角触发</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>from <span class="token operator">===</span> <span class="token string">'button'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 来自页面内转发按钮</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> doctor <span class="token operator">=</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>shareDoctor<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">'医生详情'</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/pages/doctorDetail/doctorDetail?doctor=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>doctor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre></div><h4 id="小程序海报插件使用"><a href="#小程序海报插件使用" class="header-anchor">#</a> 小程序海报插件使用</h4> <p>主要原理是,将页面的wxml元素转画到一个canvas画布上，然后画布可以使用wx.canvasToTempFilePath接口将canvas的内容转成图片保存到手机上</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
<span class="token keyword">import</span> Wxml2Canvas <span class="token keyword">from</span> <span class="token string">'wxml2canvas'</span>

  <span class="token function">drawImage1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>drawImage1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Wxml2Canvas</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        width<span class="token operator">:</span> <span class="token number">375</span><span class="token punctuation">,</span> <span class="token comment">// 宽， 以iphone6为基准，传具体数值，其他机型自动适配</span>
        height<span class="token operator">:</span> <span class="token number">667</span><span class="token punctuation">,</span> <span class="token comment">// 高</span>
        element<span class="token operator">:</span> <span class="token string">'canvas1'</span><span class="token punctuation">,</span>
        background<span class="token operator">:</span> <span class="token string">'#f0f0f0'</span><span class="token punctuation">,</span>
        <span class="token function">progress</span> <span class="token punctuation">(</span><span class="token parameter">percent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>percent<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">finish</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                imgs<span class="token operator">:</span>url<span class="token punctuation">,</span>
                posterHidden<span class="token operator">:</span><span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">error</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        list<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">'wxml'</span><span class="token punctuation">,</span>
            <span class="token keyword">class</span><span class="token operator">:</span> <span class="token string">'.share__canvas1 .draw_canvas'</span><span class="token punctuation">,</span> <span class="token comment">// draw_canvas指定待绘制的元素</span>
            limit<span class="token operator">:</span> <span class="token string">'.share__canvas1'</span><span class="token punctuation">,</span> <span class="token comment">// 限定绘制元素的范围，取指定元素与它的相对位置</span>
            x<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            y<span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>drawImage1<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//将canvas转换成图片的一个API</span>
 wx<span class="token punctuation">.</span><span class="token function">canvasToTempFilePath</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    x<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    y<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    canvasId<span class="token operator">:</span><span class="token string">'canvas1'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
      wx<span class="token punctuation">.</span><span class="token function">saveImageToPhotosAlbum</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        filePath<span class="token operator">:</span>res<span class="token punctuation">.</span>tempFilePath<span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
          wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            title<span class="token operator">:</span> <span class="token string">'保存成功'</span><span class="token punctuation">,</span>
            icon<span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span>
            duration<span class="token operator">:</span> <span class="token number">2000</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            posterVisible<span class="token operator">:</span><span class="token boolean">false</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">fail</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fail</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="小程序多图片上传"><a href="#小程序多图片上传" class="header-anchor">#</a> 小程序多图片上传</h4> <p>小程序目前不支持多图片上传，只能使用循环调用接口，进行多图片上传</p></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div class="container" data-v-0178ff65><canvas id="live2d" width="280" height="250" class="live2d-right" data-v-0178ff65></canvas></div></div></div>
    <script src="/assets/js/app.de8a721d.js" defer></script><script src="/assets/js/3.7510b978.js" defer></script><script src="/assets/js/1.c4dab98e.js" defer></script><script src="/assets/js/126.83880fa0.js" defer></script>
  </body>
</html>
