(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{583:function(t,s,a){"use strict";a.r(s);var r=a(4),e=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h4",{attrs:{id:"dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[t._v("#")]),t._v(" DockerFile")]),t._v(" "),a("p",[t._v("DockerFile是构建docker图像的基本配置文件，主要作用就是描述图像的构成文件")]),t._v(" "),a("p",[t._v("官方的例子")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FROM")]),t._v(" php"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.6")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("apache\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUN")]),t._v(" a2enmod rewrite\n# install the "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PHP")]),t._v(" extensions we need\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUN")]),t._v(" apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" update "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" install "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("y libpng12"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("dev libjpeg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("dev "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" rm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("rf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("apt"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lists"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/* \\\n  && docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n  && docker-php-ext-install gd RUN docker-php-ext-install mysqli\nVOLUME /var/www/html\n\nENV WORDPRESS_VERSION 4.2.2\nENV WORDPRESS_UPSTREAM_VERSION 4.2.2\nENV WORDPRESS_SHA1 d3a70d0f116e6afea5b850f793a81a97d2115039\n# upstream tarballs include ./wordpress/ so this gives us /usr/src/wordpress\n\nRUN curl -o wordpress.tar.gz -SL https://wordpress.org/wordpress-${WORDPRESS_UPSTREAM_VERSION}.tar.gz \\\n  && echo "$WORDPRESS_SHA1 *wordpress.tar.gz" | sha1sum -c - \\\n  && tar -xzf wordpress.tar.gz -C /usr/src/ \\\n  && rm wordpress.tar.gz \\\n  && chown -R www-data:www-data /usr/src/wordpress\n\n\nCOPY docker-entrypoint.sh /entrypoint.sh\n# grr, ENTRYPOINT resets CMD now\nENTRYPOINT ["/entrypoint.sh"]\nCMD ["apache2-foreground"]\n\n')])])])]),a("p",[t._v("它分为4个参数设置")]),t._v(" "),a("ul",[a("li",[t._v("FORM")]),t._v(" "),a("li",[t._v("COPY")]),t._v(" "),a("li",[t._v("WORKDIR")]),t._v(" "),a("li",[t._v("RUN")]),t._v(" "),a("li",[t._v("EXPOSE")]),t._v(" "),a("li",[t._v("CMD")])]),t._v(" "),a("h4",{attrs:{id:"form"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#form"}},[t._v("#")]),t._v(" FORM")]),t._v(" "),a("p",[t._v("FORM参数，配置当前环境的来源")]),t._v(" "),a("p",[t._v("例如 FROM node:8.4：该 image 文件继承官方的 node image，冒号表示标签，这里标签是8.4，即8.4版本的 node。\nFORM可以配置多个环境")]),t._v(" "),a("h4",{attrs:{id:"copy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#copy"}},[t._v("#")]),t._v(" COPY")]),t._v(" "),a("div",{staticClass:"language-docker extra-class"},[a("pre",{pre:!0,attrs:{class:"language-docker"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" docker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("entrypoint.sh /entrypoint.sh\n")])])]),a("p",[t._v("它可以将文件（与Dockerfile位于同一目录中）复制到容器中。")]),t._v(" "),a("h4",{attrs:{id:"workdir"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#workdir"}},[t._v("#")]),t._v(" WORKDIR")]),t._v(" "),a("p",[t._v("设置当前的工作目录，默认工作目录是当前目录")]),t._v(" "),a("h4",{attrs:{id:"run"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#run"}},[t._v("#")]),t._v(" RUN")]),t._v(" "),a("p",[t._v("相当于shell，可以执行一些脚本命令，")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUN")]),t._v(" git config http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("postBuffer "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("524288000")]),t._v(" \\\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" git config "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("global http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lowSpeedLimit "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" \\\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" git config "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("global http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lowSpeedTime "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("999999")]),t._v("\\；\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUN")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" git init\\\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" npm install\n")])])]),a("ul",[a("li",[a("p",[t._v("使用&&多端构建")])]),t._v(" "),a("li",[a("p",[t._v("多阶段构建使您可以大幅度减小最终图像的大小，而不必努力减少中间层和文件的数量。")])]),t._v(" "),a("li",[a("p",[t._v("由于映像是在生成过程的最后阶段生成的，因此可以利用生成缓存来最小化映像层。")])])]),t._v(" "),a("h4",{attrs:{id:"expors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#expors"}},[t._v("#")]),t._v(" EXPORS")]),t._v(" "),a("p",[t._v("将容器 3000 端口暴露出来， 允许外部连接这个端口。")]),t._v(" "),a("h4",{attrs:{id:"cmd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cmd"}},[t._v("#")]),t._v(" CMD")]),t._v(" "),a("h4",{attrs:{id:"运行命令行命令-cmd-node-app-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行命令行命令-cmd-node-app-js"}},[t._v("#")]),t._v(" 运行命令行命令 CMD['node','app.js']")])])}),[],!1,null,null,null);s.default=e.exports}}]);