(window.webpackJsonp=window.webpackJsonp||[]).push([[105],{585:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h4",{attrs:{id:"微信js-sdk配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#微信js-sdk配置"}},[t._v("#")]),t._v(" 微信js-sdk配置")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v(" * 微信公众平台的开发者账号\n * 一个服务器，开放443端口并且配置ssl 使用https 域名设置\n * 申请微信公众平台进入公众号设置js接口安全域名\n")])])]),a("h4",{attrs:{id:"开始使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开始使用"}},[t._v("#")]),t._v(" 开始使用")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("* 在需要引用的页面中引入 http://res.wx.qq.com/open/js/jweixin-1.4.0.js\n* 输入配置信息\n")])])]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("     wx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("config")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       debug"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。")]),t._v("\n       appId"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必填，公众号的唯一标识")]),t._v("\n       timestamp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必填，生成签名的时间戳")]),t._v("\n       nonceStr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必填，生成签名的随机串")]),t._v("\n       signature"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必填，签名")]),t._v("\n       jsApiList"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 必填，需要使用的JS接口列表")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ol",[a("li",[t._v("在配置文件中我们需要填写申请的appid 生成时间戳，生成的随机字符串，微信后台返回的签名，还有需要使用的接口列表\n"),a("ul",[a("li",[t._v("appid 是申请的账号id")]),t._v(" "),a("li",[t._v("timestamp 当前时间生成的时间戳")]),t._v(" "),a("li",[t._v("nonceStr 是填写服务器时的字符串")])])])]),t._v(" "),a("h4",{attrs:{id:"获取signature"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取signature"}},[t._v("#")]),t._v(" 获取signature")]),t._v(" "),a("ul",[a("li",[t._v("首先要获取access_token\n服务端发送请求携带参数请求 "),a("a",{attrs:{href:"https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=APPID&secret=APPSECRET",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=APPID&secret=APPSECRET"),a("OutboundLink")],1),t._v("\n接受到返回的参数就是access_token 和有效时间")]),t._v(" "),a("li",[t._v("获取到了access_token后要使用这个token获取Ticket\n携带参数发起请求到'"),a("a",{attrs:{href:"https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token"),a("OutboundLink")],1),t._v("=' + token + '&type=jsapi';")]),t._v(" "),a("li",[t._v("getNonceStr 处理字符串\n字符串是在后台配置时填写的")]),t._v(" "),a("li",[t._v("生成时间戳\n时间戳有位数限制需要转换单位")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("拼接字符串")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("\n     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//以如下格式拼接字符串")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" str "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jsapi_ticket='")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" jsapi_ticket "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" ‘"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("noncestr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("’ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" noncestr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" ‘"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("timestamp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("’ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" timestamp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" ‘"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("’ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" url\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v(" * 将拼接的字符串使用sha1()算法加密，然后返回给前端页面\n * 前端页面引入的js文件会对这个ticke进行检查，是否合法\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);