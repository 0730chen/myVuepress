---
title: 常用的正则表达式
date: 2020-08-21
tags:
- 正则
- Function
categories:
- 正则
---

##### 判断是否为移动端浏览器

```javascript

let regex = /(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i
```

##### 必须包含大小写字母、数字、特殊符号其中3项，长度不少于8位

```javascript

let regex = /^(?![a-zA-Z]+$)(?![A-Z0-9]+$)(?![A-Z\W_!@#$%^&*`~()-+=]+$)(?![a-z0-9]+$)(?![a-z\W_!@#$%^&*`~()-+=]+$)(?![0-9\W_!@#$%^&*`~()-+=]+$)[a-zA-Z0-9\W_!@#$%^&*`~()-+=]{8,16}$/,
```

##### 名称允许汉字、字母、数字，域名只允许英文域名（邮箱正则）

```javascript
let regex = /^[0-9a-zA-Z]+([.\-_]*[0-9a-zA-Z]+)*@([0-9a-zA-Z]+[-_]*[0-9a-zA-Z]+\.)+[0-9a-zA-Z]{2,6}$/,
```

##### 用户名为大小写字母数组组成

```javascript
let regex = /[A-Za-z0-9]+/,
```

##### 手机号13位手机号

```javascript
 let regex = /0?(13|14|15|18|17)[0-9]{9}/,
```

##### 固定电话，7-18位不能有空格

```javascript
let regex =  /[0-9-()（）]{7,18}/,

```

##### QQ号

```javascript

let regex = /[1-9]([0-9]{4,10})/,
```

##### 身份证

```javascript
let regex = /^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/

```

##### 去除字符串中的object字符串,比type更精确的

```javascript
var type = function(o) {
  var s = Object.prototype.toString.call(o);
  return s.match(/\[object (.*?)\]/)[1].toLowerCase();
};
```

```javascript

export const rules = {
    LoginName(str) { //登录名
        if (str == false) {
            return { result: false, errMsg: "请输入正确格式登录名" };
        }
        const regex = /^[^*+=/|"\[\];,><?:]{0,64}$/;
        return valid(str, regex, '登录名包含不可用字符（*;+,=|/[]><?:"）');
    },
    Password(str) { //密码
        const regex = /^[a-zA-Z0-9-_\~!@#\$%\^&\*\.\(\)\[\]\{\}<>]{2,25}$/;
        return valid(str, regex, "密码长度2-25个数字、字母和特殊字符（-_\~!@#$%^&*.()[]{}<>）");
    },
    SsPassword(str) { //数据强密码
        const regex = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9]).{8,64}$/;
        return valid(str, regex, "密码强度不够。长度8-64，并包含大写字母、小写字母、数字和非字母符号");
    },

    IP(str) { //IP
        const regex = /^((([0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3})|((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)))$/;
        return valid(str, regex, "请输入正确的IP地址")
    },

    IPEnter(str) { //带换行的多IP校验
        const regex = /^((([0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3})|((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)))$/;
        const regexIPv4 = /^([0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3}$/
        let flag = true;
        let strF = "";
        if (str.indexOf("\n") >= 0) {
            let strArr = str.split(/[\r\n,]/g);
            for (let i = 0; i < strArr.length; i++) {
                if (regexIPv4.test(strArr[i])) {
                    let lastIndex = strArr[i].split('.')[3];
                    if (lastIndex == '0' || lastIndex == '00' || lastIndex == '000') {
                        return {
                            result: false,
                            errMsg: "最后一位数字必须大于0"
                        };
                    } else {
                        if (regex.test(strArr[i]) == false) {
                            flag = false;
                            strF = strArr[i]
                        }
                    };
                } else {
                    return {
                        result: false,
                        errMsg: "请输入正确的IPV4地址(A.B.C.D)或IPV6地址(X:X::X:X)"
                    };
                };
            };
            if (!flag) {
                return valid(strF, regex, "请输入正确的IPV4地址(A.B.C.D)或IPV6地址(X:X::X:X)")
            } else {
                return valid(strArr[0], regex, "请输入正确的IPV4地址(A.B.C.D)或IPV6地址(X:X::X:X)")
            }
        }
        return valid(str, regex, "请输入正确的IPV4地址(A.B.C.D)或IPV6地址(X:X::X:X)")
    },

    IPV4(str) { //IPV4
        const regex = /^([0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3}$/
        return valid(str, regex, window.vm.$t('Auth.ipv4error'))
    },

    IPV6(str) { //IPV6
        const regex = /^(((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)$/;
        return valid(str, regex, window.vm.$t('Auth.ipv6error'))
    },

    Subnet4(str) { //子网校验 v4(10.0.5.205/64 或者 10.0.5.205/255.255.255.0)"
        const regex = /^(([0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3}\/([0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3})|(([0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3}\/\d{1,2})$/;
        return valid(str, regex, "格式不正确")
    },

    Subnet6(str) { //子网校验 v6(10.0.5.205/64 或者 10.0.5.205/255.255.255.0)
        const regex = /^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)\/\d{1,2})$/;
        return valid(str, regex, "格式不正确")
    },
    Mask_ipv4(str) { //ipv4前缀校验
        const regex = /^(\d|1\d|2\d|3[0-2])$/;
        return valid(str, regex, "格式有误,有效范围0-32")
    },
    Mask2_ipv4(str) { //ipv4掩码校验
        const regex = /^((((25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d))))\.){3}((25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d))))\/([1-9]|[1-2]\d|3[0-2]))$/;
        return valid(str, regex, "IPV4地址/掩码格式错误，掩码有效范围1-32")
    },
    Mask2_ipv6(str) {
        var regex = /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/;
        return valid(str, regex, "IPV6地址/前缀格式错误，掩码有效范围0-128")
    },
    Mask_ipv6(str) { //ipv6前缀校验
        const regex = /^(\d|[1-9]\d|1[0-1]\d|12[0-8])$/;
        // 格式有误,有效范围0-128
        return valid(str, regex, window.vm.$t('sysMan.prefixErr'))
    },
    NewIpRange(str) { //所有ip4、6段效验
        let regDefault = "^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$" +
            "|^(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\-((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))|(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))$" +
            "|^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]|(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$)))$" +
            "|^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])(\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])){3}$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\-((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$"
        const regex = new RegExp(regDefault);
        return valid(str, regex, window.vm.$t('header.iperr'))
    },
    NewIpRangeTrust(str) { //所有ip4、6段效验--信任主机
        let regDefault = "^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$" +
            "|^(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\-((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-4]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))|(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))$" +
            "|^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]|(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$)))$" +
            "|^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])(\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])){3}$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\-((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$"
        const regex = new RegExp(regDefault);
        return valid(str, regex, window.vm.$t('header.iperr'))
    },
    NewIpRange1(str) { //所有ip4、6效验
        let regDefault = "^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$" +
            "|^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]|(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$)))$" +
            "|^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])(\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])){3}$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$" 
        const regex = new RegExp(regDefault);
        return valid(str, regex, window.vm.$t('header.iperr'))
    },
    Mac(str) { //mac校验
        const regex = /^[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}$/;
        return valid(str, regex, window.vm.$t('sysSet.placehoder_Mac1'))
    },
    MacNet(str) { //mac校验
        const regex = /^[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}$/;
        return valid(str, regex, "MAC格式不正确")
    },

    UserID(str) { //用户ID
        const regex = /^[a-zA-Z0-9_-]{2,32}$/;
        return valid(str, regex, "格式有误，允许输入2-32数字、字母、下划线组合")
    },
    ConfigName(str) { //备份文件名称校验
        const regex = /^[a-zA-Z0-9_-]{1,32}$/;
        return valid(str, regex, "请输入1-32数字、字母、下划线组合")
    },
    ConfigFilename(str) { //数据库名称校验
        const regex = /^[a-zA-Z0-9_-]{3,20}$/;
        return valid(str, regex, "请输入3-20位字母、数字及下划线格式")
    },
    Username(str) { //用户名称校验
        const regex = /^[\s\S]{0,20}$/;
        return valid(str, regex, "请输入20位以内的字母、数字及下划线格式的用户名")
    },
    Breakbaord(str) { //不包含空格的0-128位字符
        const regex = /^[^ ]{0,128}/;

        return valid(str, regex, "不能包含空格")
    },
    SecretKey(str) { //不包含空格的1-64位字符
        const regex = /^[^ ]{1,64}/;
        return valid(str, regex, "密钥不能超过64位，且不包含空格")
    },
    Departname(str) { //部门名称校验
        const regex = /^[^/]{1,50}$/;
        return valid(str, regex, "部门名称不能包含以下字符：/")
    },
    DeviceName(str) { //设备名称校验
        const regexSpace = /\s/;
        const regex = /^[^@/]{1,50}$/;
        if (regexSpace.test(str)) {
            return { result: false, errMsg: "设备名称不能包含空白符和以下字符：@ /" }
        } else {
            return valid(str, regex, "设备名称不能包含空白符和以下字符：@ /")
        }
    },
    DeviceOperaName(str) { //设备组名称校验
        const regex = /^[^,]{1,50}$/;
        return valid(str, regex, "设备组名称不能包含以下字符：,")
    },
    FtpPsw(str) { //密码校验
        const regex = /^[\s\S]{0,20}$/;
        return valid(str, regex, "请输入20位以内的字母、数字及下划线格式的密码")
    },

    HostPsw(str) { //主机密码校验
        const regex = /^[A-Za-z]\w{7,15}$/;
        return valid(str, regex, "请输入8-16位以字母开头数字下划线格式密码")
    },

    SnmpGroupName(str) { //团体名校验
        const regex = /^[A-Za-z]\w{7,15}$/;
        return valid(str, regex, "请输入8-16位，以字母开头的字母数字下划线格式的团体名")
    },

    HostIp(str) { //ip主机校验
        const regex = /[^`~|!@#$%^&()*_+<>{}\/'[\]\s]{1,50}$/;
        return valid(str, regex, "格式不正确")
    },

    Http(str) { //http校验
        const regex = /^(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'((\\)?\()((\\)?\))\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'((\\)?\()((\\)?\))\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'((\\)?\()((\\)?\))\*\+,;=]|:|@)*)*)?)?(((\\)?\?)((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'((\\)?\()((\\)?\))\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|((\\)?\?))*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'((\\)?\()((\\)?\))\*\+,;=]|:|@)|\/|((\\)?\?))*)?$/;
        return valid(str, regex, "格式不正确")
    },

    Ftp(str) { //Ftp校验
        const regex = /^((([1-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){2}(\.([1-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])))|(\[(((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))(\/([1-9]|[1-9][\d]|[1][0-1][\d]|[1][2][1-8]))?)\]))(\:(65[0-4]{2}|655[0-2]\d|6553[0-5]|6[0-4][\d]{3}|[1-5][\d]{4}|[1-9][\d]{3}|[1-9][\d]{2}|[1-9][\d]|[1-9]))?$/;
        return valid(str, regex, "格式不正确")
    },

    Email(str) { // email地址
        const regex = /^(?:[a-z\d]+[_\-\+\.]?)*[a-z\d]+@(?:([a-z\d]+\-?)*[a-z\d]+\.)+([a-z]{2,})+$/;
        return valid(str, regex, "邮箱地址不合法")
    },

    Phone(str) { //手机号
        const regex = /^0?[1][345789][0-9]{9}$/;
        // return valid(str, regex, "手机号码不合法，请输入正确的11位电话号码")
        return valid(str, regex, window.vm.$t('header.mobilepho'))
    },

    Wechat(str) {
        const regex = /^[\w\.\-@]{1,32}$/
        return valid(str, regex, "微信号不合法，请输入1-32个数字、字母、字符（._-@）")
    },

    KeyWord(str) { // 部门Key值，必须包含数字小写字母
        const regexNum = /\d+/;
        const regexStr = /[a-z]+/;
        const regex = /^[\w\.\~!@#\$%\^&\*\.\(\)\[\]\{\}<>]{8,64}$/;
        if (regexNum.test(str) && regexStr.test(str)) {
            return valid(str, regex, "格式错误，请输入8-64位数字、字母、字符")
        } else {
            return { result: false, errMsg: "格式错误，key值必须包含数字与小写字母" }
        }
    },
    KeyWord2(num, lower, upper, symbol, first, str) {
        let regexNum = num ? /\d+/ : false;
        let regexStr = lower ? /[a-z]+/ : false;
        let regexStrUp = upper ? /[A-Z]+/ : false;
        let regexStrSym = symbol ? /^[\w\~\！\@\#\￥\$\^\(\)\%\…\&\*\（\）\—\+\-\=\{\}\：\“\”\"\|\《\》\？\【\】\；\;\‘\、\，\,\。\.\'\!\`\\\/\：\:\<\>\?\[\]]{8,32}$/ : false;
        let firstStr = first ? str.substring(0, 1) : false;
        if (firstStr) {
            if (firstStr == first) {
                return { result: false, errMsg: "密码不能以 " + first + " 开头" }
            }
        }
        if (regexNum) {
            if (!regexNum.test(str)) {
                return { result: false, errMsg: "格式错误，必须包含数字" }
            }
        }
        if (regexStr) {
            if (!regexStr.test(str)) {
                return { result: false, errMsg: "格式错误，必须包含小写字母" }
            }
        }
        if (regexStrUp) {
            if (!regexStrUp.test(str)) {
                return { result: false, errMsg: "格式错误，必须包含大写字母" }
            }
        }
        if (regexStrSym) {
            if (!regexStrSym.test(str)) {
                return { result: false, errMsg: "格式错误，必须包含字符" }
            }
        }
        return { result: true, errMsg: "" };
    },
    SSHBanner(str) {
        const regex = /^[\w\.\~!@#\$%\^&\*\.\(\)\[\]\{\}<>]{1,64}$/
        return valid(str, regex, "SSH banner由英文字母、数字和符号组成, 不能包含中文和空格")
    },
    PasswordKey(str) { // 8-32位密钥
        const firstStr = str.substring(0, 1);
        const regexNum = /\d+/;
        const regexStr = /[a-z]+/;
        const regex = /^[\w\~\！\@\#\￥\$\^\(\)\%\…\&\*\（\）\—\+\-\=\{\}\：\“\”\"\|\《\》\？\【\】\；\;\‘\、\，\,\。\.\'\!\`\\\/\：\:\<\>\?\[\]]{8,32}$/
            // if (firstStr == '-') {
            //     return { result: false, errMsg: "密码不能以 - 开头" }
            // } else {
        if (regexNum.test(str) && regexStr.test(str)) {
            return valid(str, regex, "格式错误，请输入8-32位数字、字母、字符")
        } else {
            return { result: false, errMsg: "格式错误，必须包含数字与小写字母" }
        }
        // }
    },
    PasswordKey2(str) { // 10-32位密钥
        const firstStr = str.substring(0, 1);
        const regexNum = /\d+/;
        const regexStr = /[a-z]+/;
        const regex = /^[\w\~\！\@\#\￥\$\^\(\)\%\…\&\*\（\）\—\+\-\=\{\}\：\“\”\"\|\《\》\？\【\】\；\;\‘\、\，\,\。\.\'\!\`\\\/\：\:\<\>\?\[\]]{10,32}$/
            // if (firstStr == '-') {
            //     return { result: false, errMsg: "密码不能以 - 开头" }
            // } else {
        if (regexNum.test(str) && regexStr.test(str)) {
            return valid(str, regex, "格式错误，请输入10-32位数字、字母、字符")
        } else {
            return { result: false, errMsg: "格式错误，必须包含数字与小写字母" }
        }
        // }
    },
    PasswordKeyApp(str) { // 应用管理8-32位密钥
        // const firstStr = str.substring(0, 1);
        const regexNum = /\d+/;
        const regexStr = /[a-z]+/;
        const regexStrUp = /[A-Z]+/;
        const regex = /^[\w\~\！\@\#\￥\$\^\(\)\%\…\&\*\（\）\—\+\-\=\{\}\：\“\”\"\|\《\》\？\【\】\；\;\‘\、\，\,\。\.\'\!\`\\\/\：\:\<\>\?\[\]]{8,32}$/
            // if (firstStr == '-') {
            //     return { result: false, errMsg: "密码不能以 - 开头" }
            // } else {
        if (regexNum.test(str) && regexStr.test(str) && regexStrUp.test(str)) {
            return valid(str, regex, "格式错误，请输入8-32位数字、字母、字符")
        } else {
            return { result: false, errMsg: "格式错误，必须包含数字、小写字母和大写字母" }
        }
        // }
    },
    secretKey(str) { // 1-120位数字字母验证码
        const regex = /^[a-zA-Z0-9]{1,120}$/
        return valid(str, regex, "格式错误，请输入1-120位数字、字母")
    },
    secretKey2(str) { // 1-128位数字字母验证码
        const regex = /^[a-zA-Z0-9]{1,128}$/
        return valid(str, regex, "格式错误，请输入1-128位数字、字母")
    },
    PwdExportKey(str) { // 1-64位密钥
        const regex = /^[a-zA-Z0-9]{1,64}$/
        return valid(str, regex, "格式错误，请输入1-64位数字、字母")
    },
    Name(str) { //名称校验
        const regex = /^[a-zA-Z0-9_\u4e00-\u9FA5]{2,64}$/;
        return valid(str, regex, "只允许输入2-64位数字中文英文和下划线")
    },

    KnowledgeName(str) { //知识名称
        const regex = /^[\u0391-\uFFE5\w·\[\]\.-]{2,16}$/;
        return valid(str, regex, "只能输入正整数")
    },

    Desc(str) { //描述校验
        const regex = /^.{1,256}$/
        return valid(str, regex, "1-256位任意字符")
    },

    Port(str) { //端口号校验   /^(65[0-4]{2}|655[0-2]\d|6553[0-5]|6[0-4][\d]{3}|[1-5][\d]{4}|[1-9][\d]{3}|[1-9][\d]{2}|[1-9][\d]|[1-9])$/;   /^(65[0-4]{2}|655[0-2]\d|6553[0-5]|6[0-4][\d]{3}|[1-5][\d]{4}|[1-9][\d]{3}|[1-9][\d]{2}|[1-9][\d]|[1-9])$/;
        //const regex = /^(6[0-4]\d{4}|65[0-4]\d{2}|655[0-2]\d|6553[0-5]|[1-5]\d{4}|[1-9]\d{1,3}|[1-9])$/;
        const regex = /^(65[0-4][\d]{2}|65[0-4]{2}|655[0-2]\d|6553[0-5]|6[0-4][\d]{3}|[1-5][\d]{4}|[1-9][\d]{3}|[1-9][\d]{2}|[1-9][\d]|[1-9])$/;
        return valid(str, regex, window.vm.$t('noticeOut.ddrules.r1'))
    },
    length365(str) {
        const regex = /^([1-9]|[1-9][0-9]|[1-2][0-9][0-9]|[3][0-5][0-9]|36[0-5])$/;
        // 配置错误，可配范围:1-365
        return valid(str, regex, window.vm.$t('sysSet.error1_365'));
    },
    length7365(str) {
        const regex = /^([7-9]|[1-9][0-9]|[1-2][0-9][0-9]|[3][0-5][0-9]|36[0-5])$/;
        // 配置错误，可配范围:1-365
        return valid(str, regex, window.vm.$t('sysSet.error7_365'));
    },
    PortTcp(str) { //端口号/协议
        const regex = /^(65[0-4]{2}|655[0-2]\d|6553[0-5]|6[0-4][\d]{3}|[1-5][\d]{4}|[1-9][\d]{3}|[1-9][\d]{2}|[1-9][\d]|[1-9])\/([t][c][p]|[u][d][p])$/;
        return valid(str, regex, "端口(1-65535)/协议(小写字母)格式不合法")
    },

    UUID(str) { //UUID校验
        const regex = /^[a-zA-Z0-9_-]{2,64}$/
        return valid(str, regex, "格式有误,只允许2-64个输入数字、字母、_、-")
    },

    AuthKey(str) { //密钥校验
        const regex = /^[a-zA-Z0-9]{2,64}$/
        return valid(str, regex, "格式有误，允许输入2-64数字、字母组合")
    },

    FilePath(str) {
        const regex = /^\/.+\.(txt|log|tar|rar|tgz|gz|tbz|zip|bz2|7z)$/
        return valid(str, regex, "文件后缀必须为 .txt .log .tar .rar .tgz .gz .tbz .zip .bz2 .7z 其中一个")
    },

    FtpPath(str) {
        const regex = /^([\w\d]{1,64})$/
        return valid(str, regex, "格式有误,只允许输入数字、字母、-,有效范围1-64")
    },

    UpgUrl(str) { //域名加IP校验

        const regex = /^(?:(?:http(?:s?)|ftp):\/\/)?(([0-9a-zA-Z-]+\]?(?:\.[0-9a-zA-Z-]+)+)|\[(((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)\])(?::(\d{1,5}))?(?:\/[!-~]*)*$/
        return valid(str, regex, "IP或域名格式有误")
    },
    BaseUrlIP(str) { //基础配置服务器校验
        const regex = /^((([0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3})|((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))|((?!-)(?!.*?-$)[a-zA-Z0-9]{1,10}(\.[-a-zA-Z0-9]{1,10}){0,5}))$/
        return valid(str, regex, "服务器IP或域名格式有误");
    },
    IPV46Url(str) { // IP加域名校验
        const regex = /^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$|^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$|^(?:(?:(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):){6})(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):(?:(?:[0-9a-fA-F]{1,4})))|(?:(?:(?:(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9]))\.){3}(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9])))))))|(?:(?:::(?:(?:(?:[0-9a-fA-F]{1,4})):){5})(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):(?:(?:[0-9a-fA-F]{1,4})))|(?:(?:(?:(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9]))\.){3}(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9])))))))|(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})))?::(?:(?:(?:[0-9a-fA-F]{1,4})):){4})(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):(?:(?:[0-9a-fA-F]{1,4})))|(?:(?:(?:(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9]))\.){3}(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9])))))))|(?:(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):){0,1}(?:(?:[0-9a-fA-F]{1,4})))?::(?:(?:(?:[0-9a-fA-F]{1,4})):){3})(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):(?:(?:[0-9a-fA-F]{1,4})))|(?:(?:(?:(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9]))\.){3}(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9])))))))|(?:(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):){0,2}(?:(?:[0-9a-fA-F]{1,4})))?::(?:(?:(?:[0-9a-fA-F]{1,4})):){2})(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):(?:(?:[0-9a-fA-F]{1,4})))|(?:(?:(?:(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9]))\.){3}(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9])))))))|(?:(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):){0,3}(?:(?:[0-9a-fA-F]{1,4})))?::(?:(?:[0-9a-fA-F]{1,4})):)(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):(?:(?:[0-9a-fA-F]{1,4})))|(?:(?:(?:(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9]))\.){3}(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9])))))))|(?:(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):){0,4}(?:(?:[0-9a-fA-F]{1,4})))?::)(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):(?:(?:[0-9a-fA-F]{1,4})))|(?:(?:(?:(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9]))\.){3}(?:(?:25[0-5]|(?:[1-9]|1[0-9]|2[0-4])?[0-9])))))))|(?:(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):){0,5}(?:(?:[0-9a-fA-F]{1,4})))?::)(?:(?:[0-9a-fA-F]{1,4})))|(?:(?:(?:(?:(?:(?:[0-9a-fA-F]{1,4})):){0,6}(?:(?:[0-9a-fA-F]{1,4})))?::))))$/;
        // const regex = new RegExp(reg);
        // const regex = /^(?:(?:http(?:s?)|ftp):\/\/)?(([0-9a-zA-Z-]+\]?(?:\.[0-9a-zA-Z-]+)+)|\[(((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(\d{1,2}))\b)\.){3}(\b((25[0-5])|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)\])(?::(\d{1,5}))?(?:\/[!-~]*)*$/
        return valid(str, regex, "IP或域名格式有误")
    },
    UpgUrlEnter(str) { //带换行的多域名加IP校验
        const regex = /^(?:(?:http(?:s?)|ftp):\/\/)?(([0-9a-zA-Z-]+\]?(?:\.[0-9a-zA-Z-]+)+)|\[(((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)\])(?::(\d{1,5}))?(?:\/[!-~]*)*$/
        let flag = true;
        let strF = "";
        if (str.indexOf("\n") >= 0) {
            let strArr = str.split(/[\r\n,]/g);
            for (let i = 0; i < strArr.length; i++) {
                if (regex.test(strArr[i]) == false) {
                    flag = false;
                    strF = strArr[i]
                }
            };
            if (!flag) {
                return valid(strF, regex, "URL地址格式有误")
            } else {
                return valid(strArr[0], regex, "URL地址格式有误")
            }
        }
        return valid(str, regex, "URL地址格式有误")
    },

    Domain(str) { //域名
        const regex = /^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z]{2,})+$/;
        return valid(str, regex, "域名格式有误")
    },

    Url(str) { //网址
        const reg = "^((https|http|ftp|rtsp|mms)?://)" +
            +"(([0-9a-zA-Z_!~*'().&=+$%-]+: )?[0-9a-zA-Z_!~*'().&=+$%-]+@)?" //ftp的user@
            +
            "(([0-9]{1,3}\.){3}[0-9]{1,3}" // IP形式的URL- 199.194.52.184
            +
            "|" // 允许IP和DOMAIN（域名）
            +
            "([0-9a-zA-Z_!~*'()-]+\.)*" // 域名- www.
            +
            "([0-9a-zA-Z][0-9a-zA-Z-]{0,61})?[0-9a-zA-Z]+\." // 二级域名
            +
            "[a-zA-Z]{2,6})" // first level domain- .com or .museum
            +
            "(:[0-9]{1,4})?" // 端口- :80
            +
            "((/?)|" // a slash isn't required if there is no file name
            +
            "(/[0-9a-zA-Z_!~*'().;?:@&=+$,%#-]+)+/?)$";
        const regex = new RegExp(reg);
        return valid(str, regex, "URL格式有误")
    },

    IPUrl(str) { //IP+域名校验
        const reg = "^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z]{2,})+$" +
            "^((https|http|ftp|rtsp|mms)?://)" +
            +"(([0-9a-zA-Z_!~*'().&=+$%-]+: )?[0-9a-zA-Z_!~*'().&=+$%-]+@)?" //ftp的user@
            +
            "(([0-9]{1,3}\.){3}[0-9]{1,3}" // IP形式的URL- 199.194.52.184
            +
            "|" // 允许IP和DOMAIN（域名）
            +
            "([0-9a-zA-Z_!~*'()-]+\.)*" // 域名- www.
            +
            "([0-9a-zA-Z][0-9a-zA-Z-]{0,61})?[0-9a-zA-Z]\." // 二级域名
            +
            "[a-zA-Z]{2,6})" // first level domain- .com or .museum
            +
            "(:[0-9]{1,4})?" // 端口- :80
            +
            "((/?)|" // a slash isn't required if there is no file name
            +
            "(/[0-9a-zA-Z_!~*'().;?:@&=+$,%#-]+)+/?)$" +
            "|^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$" +
            "|^(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\-((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))|(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))$" +
            "|^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]|(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$)))$" +
            "|^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])(\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])){3}$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$";
        const regex = new RegExp(reg);
        return valid(str, regex, "IP或域名格式有误")
    },
    // 最新IP加域名校验
    IPV46HostName(str) {
        const regexHost = /^[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?$/;
        // const regexHost = /^([a-z0-9]+([a-z0-9-]*(?:[a-z0-9]+))?\.)?[a-z0-9]+([a-z0-9-]*(?:[a-z0-9]+))?(\.us|\.tv|\.org\.cn|\.org|\.net\.cn|\.net|\.mobi|\.me|\.la|\.info|\.hk|\.gov\.cn|\.edu|\.com\.cn|\.com|\.co\.jp|\.co|\.cn|\.cc|\.biz)$/;
        let regDefault = "^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$" +
            "|^(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\-((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))|(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))$" +
            "|^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]|(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$)))$" +
            "|^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])(\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])){3}$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$";
        const regex = new RegExp(regDefault);
        // const regexHttp = /^(?:(?:http(?:s?)|ftp):\/\/)?(([0-9a-zA-Z-]+\]?(?:\.[0-9a-zA-Z-])$/;
        if (!regex.test(str)) {
            return valid(str, regexHost, window.vm.$t('noticeOut.ddrules.r2'))
        } else {
            return {
                result: true,
                errMsg: ""
            };
        }
    },
    // 安恒IP域名校验
    checkAssetIP(ipstr) {
        function ip127(ipstr) {
            if (!checkIP2(ipstr)) {
                return false;
            }
            var dec = ip2long(ipstr)
            if (dec >= 2130706432 && dec <= 2147483647) {
                return true;
            }
            return false;
        };

        function checkIP2(ipstr) {
            var pattern = /^((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|[0-9])(\.((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|[0-9])){3}$/;
            if (pattern.test(ipstr)) {
                return true;
            }
            return false;
        };

        function ip2long(ipstr) {
            var res = false;
            if (checkIP2(ipstr)) {
                var nums = ipstr.split('.');
                res = 0;
                res = (nums[0] * Math.pow(256, 3)) + (nums[1] * Math.pow(256, 2)) + (nums[2] * Math.pow(256, 1)) + (nums[3] * Math.pow(256, 0));
            }
            return res;
        };
        if (ipstr.length > 100) {
            // IP或域名格式有误
            return { result: false, errMsg: window.vm.$t('noticeOut.ddrules.r2') };
        }
        if (ipstr == '0.0.0.0' || ipstr == '255.255.255.255' || ip127(ipstr)) {
            return { result: false, errMsg: window.vm.$t('noticeOut.ddrules.r2') };
        }
        var pattern = /^[-\.:a-zA-Z0-9]*$/;
        if (!pattern.test(ipstr)) {
            return { result: false, errMsg: window.vm.$t('noticeOut.ddrules.r2') };
        }
        return { result: true, errMsg: "" };
    },
    // 资产列表校验
    checkAssetList(assStr) {
        if (assStr.indexOf(";") < 0) { //此时代表一个
            if (assStr.length > 8) { //一个的时候长度大于8则报错
                return { result: false, errMsg: "资产列表格式错误" }
            }
        }
        let assArr = assStr.split(';');
        if (assArr.length > 3) {
            return { result: false, errMsg: "资产列表格式错误" }
        } else {
            for (let i = 0; i < assArr.length; i++) {
                if (assArr[i].length > 8) {
                    return { result: false, errMsg: "资产列表格式错误" }
                }
            }
        }
        return { result: true, errMsg: "" };
    },
    UrlEnter(str) { //带换行的多域名校验
        const regex = /^(?:(?:http(?:s?)|ftp):\/\/)?(([0-9a-zA-Z-]+\]?(?:\.[0-9a-zA-Z-]+)+)|\[(((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)\])(?::(\d{1,5}))?(?:\/[!-~]*)*$/;
        let flag = true;
        let strF = "";
        if (str.indexOf("\n") >= 0) {
            let strArr = str.split(/[\r\n,]/g);
            for (let i = 0; i < strArr.length; i++) {
                if (regex.test(strArr[i]) == false) {
                    flag = false;
                    strF = strArr[i]
                }
            };
            if (!flag) {
                return valid(strF, regex, "域名地址格式有误")
            } else {
                return valid(strArr[0], regex, "域名地址格式有误")
            }
        }
        return valid(str, regex, "域名地址格式有误")
    },

    MD5(str) { //MD5校验
        const regex = /^([a-f\d]){32}|[A-F\d]{32}|([a-f\d]){16}|[A-F\d]{16}$/
        return valid(str, regex, "MD5格式有误")
    },
    MD5Enter(str) { //带换行的多MD5校验
        const regex = /^([a-f\d]){32}|[A-F\d]{32}|([a-f\d]){16}|[A-F\d]{16}$/;
        let flag = true;
        let strF = '';
        if (str.indexOf('\n') != -1) {
            let strArr = str.split(/[\r\n,]/g);
            for (let i = 0; i < strArr.length; i++) {
                if (regex.test(strArr[i]) == false) {
                    flag = false;
                    strF = strArr[i]
                }
            };
            if (!flag) {
                return valid(strF, regex, "MD5格式有误")
            } else {
                return valid(strArr[0], regex, "MD5格式有误")
            }
        }
        return valid(str, regex, "MD5格式有误")
    },

    IPV4Range(str) { //ipv4地址(10.0.13.1-10.0.13.9 或 10.0.13.1 或 10.0.13.1-255 或 10.0.13.0/32)
        const reg = "^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$" +
            "|^(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\-((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))|(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))$" +
            "|^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]))$";
        const regex = new RegExp(reg);
        // return valid(str, regex, "IPV4格式有误")
        return valid(str, regex, window.vm.$t('sysMan.ipv4error'))
    },
    IPV6Range(str) { //ipv6地址(2012:: 或 2012::1-2012::6 )
        const reg = "^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$";
        const regex = new RegExp(reg);
        // return valid(str, regex, "IPV6格式有误")
        return valid(str, regex, window.vm.$t('sysMan.ipv6error'))
    },
    IpRange(str) { //ipv4/ipv6 (单ip、网段、掩码,IPV6不支持网段)
        console.log(str)
        const reg = "^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$" +
            "|^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}([*]{1})$" +
            "|^(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\-((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))|(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))$" +
            "|^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]))$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$";
        const regex = new RegExp(reg);
        // return valid(str, regex, "格式有误,支持IPV4和IPV6格式")
        return valid(str, regex, window.vm.$t('valid.ipv4ipv6'))
    },
    UserName(str) {
        const regex = /^[a-zA-Z0-9_(.)\u4e00-\u9FA5]{1,64}$/;
        return valid(str, regex, "格式有误，可输入中文、数字、字母、下划线组合")
    },
    assetName(str) {
        const regex = /^[a-zA-Z0-9_.\-\u4e00-\u9FA5]{1,64}$/;
        // return valid(str, regex, "必须为中文字符、字母、数字、下划线(_)、点(.)或短横(-)，长度不超过64")  reportCenter
        return valid(str, regex, window.vm.$t('reportCenter.name64'))
    },
    //服务器地址（IP或域名）
    Server(str) {
        const regex = /^((([0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){3})|((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)))$|^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z]{2,})+$/;
        // "格式有误，请输入正确格式的IP或域名"
        return valid(str, regex, window.vm.$t('valid.ipv4Domain'));
    },
    //服务器地址新
    ServerNew(str) {
        const regex = /^((([0-9]|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])(\.(\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])){1,3})|((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)))$|^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z0-9]{2,})+$/;
        // return valid(str, regex, "格式有误，请输入正确格式的IP或域名")
        return valid(str, regex, window.vm.$t('valid.ipv4Domain'));
    },
    //http和https
    CasUrl(str) {
        const regex = /http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/
            // return valid(str, regex, "格式有误，请输入正确格式的URL")
        return valid(str, regex, window.vm.$t('Auth.urlFormaterror'))
    },
    //字符集不能包含中文
    charNot(str) {
        const regex = /^[-_`~!@#$%^&*()=+;:\"\',<.>\/?{\[}\]|\\a-zA-Z0-9]*$/
            // return valid(str, regex, "英文字母、数字和符号组成, 不能包含中文和空格")
        return valid(str, regex, window.vm.$t('noticeOut.kafkacharnot'))
    },
    UserNav(str) { //用户名
        const regex = /^[a-zA-Z0-9_-]{1,128}$/;
        return valid(str, regex, "请输入1-128数字、字母、下划线组合")
    },
    Mobile(str) { //
        const regex = /^[0-9]{1,14}$/;
        return valid(str, regex, "请输入正确的手机号")
    },
    auditRuleIpMul(str) { //规则逗号分隔多IP校验，支持10.2.8.*，10.2.*.8,10.2.8.5-10.2.8.59
        let addIpList = str;
        let regDefault = "^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$" +
            "|^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}([*]{1})$" +
            "|^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){2}([*]{1}\\.[*]{1})$" +
            "|^(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\-((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))|(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))$" +
            "|^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]))$" +
            "|^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])(\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])){3}$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$";
        const regex = new RegExp(regDefault);
        if (!_.isEmpty(str)) {
            let _ipRanges = addIpList;
            /*判断每一个IP是否符合IPV4或IPV6*/
            for (let i = 0; i < _ipRanges.length; i++) {
                let ipVal = _ipRanges[i].replace(/\s/g, ''); //去除全部空格
                if (ipVal && ipVal.indexOf('-') > -1) {
                    let rangeList = ipVal.split('-');
                    if (ipVal.indexOf('/') > -1) { return valid(str, regex, window.vm.$t('header.iperr')) }
                    if (!(rangeList && rangeList.length === 2 && rangeList[0] && rangeList[1] && regex.test(rangeList[0]) && regex.test(rangeList[1]))) {
                        // return callback(new Error("IP格式错误"))
                        // return valid(str, regex, "IP格式错误")
                        return valid(str, regex, window.vm.$t('header.iperr'))
                    }
                } else if (!regex.test(ipVal)) {
                    // return valid(str, regex, "IP格式错误")
                    return valid(str, regex, window.vm.$t('header.iperr'))
                }
            }
            // return valid(str, regex, "IP格式错误")
            return valid(str, regex, window.vm.$t('header.iperr'))
        }
        // return valid(str, regex, "IP格式错误")
        return valid(str, regex, window.vm.$t('header.iperr'))

    },
    filterRuleIpMul(str) { //过滤IP规则逗号分隔多IP掩码校验，支持10.2.8.6/10,10.3.3.36/8
        let addIpList = str;
        let regDefault =
            "|^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]))$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$";
        const regex = new RegExp(regDefault);
        if (!_.isEmpty(str)) {
            let _ipRanges = addIpList.split(',');
            /*判断每一个IP是否符合IPV4或IPV6*/
            for (let i = 0; i < _ipRanges.length; i++) {
                let ipVal = _ipRanges[i].replace(/\s/g, ''); //去除全部空格
                if (regex.test(ipVal)) {
                    return valid(str, regex, "格式错误，正确格式为“IP/掩码长度”，可输入多组，用“,”隔开，如：1.2.3.4/32,10.0.0.0/8")
                } else {
                    return { result: false, errMsg: "格式错误，正确格式为“IP/掩码长度”，可输入多组，用“,”隔开，如：1.2.3.4/32,10.0.0.0/8" }
                }
            }
            return {
                result: true,
                errMsg: ""
            };

        }


    }

}

//val:String   要校验的值
//regex:RegExp 校验正则,不是正则时val作为result的值
//msg:String   校验不通过的错误信息
function valid(val, regex, msg) {
    return { result: regex instanceof RegExp ? regex.test(val) : !!val, errMsg: msg }
}

//required 是否必填项，必填属性，默认"true"
//type:String/Function 校验类型，必填属性，
//String时必须是上面rules中存在的函数名，
//Function时只接收一个参数(输入值)，返回格式： {result:Boolean, errMsg:String}
//trigger:String 触发动作，默认"blur"
//nullMsg:String 未输入的提示语，选填，required=true时有效  默认'该字段为必填项'
//checkLength    验证字符长度  暂不使用  有需要添加
export function validateRule(required = true, type, trigger = "blur", nullMsg = "", checkLength = {
    min: 2,
    max: 20
}) {
    const rule = { required: !!required, trigger }
        //let emptyMsg = window.vm.$t('common.pleaseEnter') + nullMsg;
    let strBr = window.sessionStorage.lang == 'en' ? '\xa0' : ''
    let emptyMsg = window.vm.$t('common.pleaseEnter') + strBr + window.vm.$t(nullMsg);
    let check = null; //是否存在校验规则
    if (typeof(type) === "function") {
        check = type
    } else {
        check = type ? rules[type] : null;
    }
    if (check) { //存在规则时添加规则
        rule.validator = (r, v, c) => {
            const { result, errMsg } = check(v) //result校验结果  errMsg错误提示

            if (required) {
                //必填项:
                // if(!!checkLength){  //验证字符长度
                //     if (v.toString().length < checkLength.min || v.toString().length > checkLength.max) {
                //         return c(new Error('字符长度为' + checkLength.min + '-' + checkLength.max + '位'))
                //     }
                // }
                return (v === null || v === undefined || (v + '').trim() === "") ? c(new Error(emptyMsg)) : result ? c() : c(new Error(errMsg))

            }
            //选填项:
            return (v === null || v === undefined || (v + '').trim() === "" || result) ? c() : c(new Error(errMsg))
        }
    } else {
        rule.message = emptyMsg
    }

    return [rule]
}
/*
 *多个IP
 * 参数:value- 输入值
 * 参数:obj - {max:最大可以输入多少个，默认1000，ipType:'4'/'6'，exception:'all'(例外字段，遇到输入值和该字段相同则校验通过)}
 * IPV6不支持网段输入
 * */
function validateMultiIp(value, obj) {
    //例外字段
    if (obj.exception && value === obj.exception) {
        return { result: !!value, errMsg: "" }
    }
    /*ipv4校验规则集合  [0-ip，1-网段(用-隔开)，2-掩码,3 - 10.*.*.*]*/
    /* let regIpv4Rule = {
         0:"^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$",
         1:"^(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\-((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))|(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))$",
         2:"^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]))$"
         3:"^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5]|\*)){3}$"
     };*/
    /*ipv4校验规则集合 [0-ip，1-网段(用-隔开)，2-掩码]*/
    /*  let regIpv6Rule = {
          0: "^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$",
          1: "^(((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)\\-(((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))|[0-9A-Fa-f]{1,4})$",
          2: "^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$"
      };*/
    let regDefault;
    /*校验IPV4、IPV6*/
    if (obj.ipType === '4') {
        regDefault = "^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$" +
            "|^(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\-((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))|(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))$" +
            "|^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]))$" +
            "|^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])(\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5]|\\*)){3}$"
    } else if (obj.ipType === '6') {
        regDefault = "^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$" +
            "|^(((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::)\\-(((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))|[0-9A-Fa-f]{1,4})$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$";

    } else if (obj.ipType === 'all') {
        regDefault = "^((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))$" +
            "|^(((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\-((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))|(25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))$" +
            "|^((((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\.){3}((25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d))))\\/(\\d|[1-2]\\d|3[0-2]))$" +
            "|^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])(\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5]|\\*)){3}$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))$" +
            "|^((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\/(\\d|[1-9]\\d|1[0-2][0-8])$";

    }
    const regex = new RegExp(regDefault);
    value = value && value.trim();
    if (value) {
        let _ipRanges = value.replace(new RegExp(obj.splitSymbol, "g"), "$").split("$");
        if (_ipRanges.length > obj.max) {
            return { result: false, errMsg: "超出最大限制数" }
        }
        /* if (hasDuplicates(_ipRanges)) {
             return { result: false, errMsg: 'IP有重复值，请检查' }
         }*/
        /*判断每一个IP是否符合IPV4或IPV6*/
        for (let i = 0; i < _ipRanges.length; i++) {
            let ipVal = _ipRanges[i].replace(/^\s+|\s+$/g, ''); //去除首尾空格
            if (ipVal.indexOf('!') === -1 && !regex.test(ipVal)) {
                return { result: false, errMsg: window.vm.$t('header.iperr') }
            }
            //输入非的情况
            if (ipVal && ipVal.indexOf('!') > -1 && !regex.test(ipVal.split('!')[1])) {
                return { result: false, errMsg: window.vm.$t('header.iperr') }
            }
        }
    } else {
        return { result: !!value, errMsg: "" }
    }
    return { result: !!value, errMsg: "" }
}
/*多个端口*/
function validateMultiPort(value, obj) {
    value = value && value.trim();
    const regex = /^(65[0-4][\d]{2}|65[0-4]{2}|655[0-2]\d|6553[0-5]|6[0-4][\d]{3}|[1-5][\d]{4}|[1-9][\d]{3}|[1-9][\d]{2}|[1-9][\d]|[1-9])$/;
    let validatePortRange = function(portRange) {
        let regPort = /^\d{1,5}$/;
        let startPort = portRange.split('-')[0],
            endPort = portRange.split('-')[1];
        return (regPort.test(startPort) && (startPort >= 0) && (startPort <= 65535)) && (regPort.test(endPort) && (endPort >= 0) && (endPort <= 65535) && endPort - startPort > 0);
    };
    if (value) {
        let inputArr = value.replace(new RegExp(obj.splitSymbol, "g"), "$").split("$");
        if (obj.max < inputArr.length) {
            return { result: false, errMsg: '端口个数超出限制' }
        }
        if (hasDuplicates(inputArr)) {
            return { result: false, errMsg: '端口有重复值，请检查' }
        }
        for (let i = 0; i < inputArr.length; i++) {
            let value = inputArr[i].replace(/^\s+|\s+$/g, ''); //去除首尾空格
            if (value.indexOf('-') > -1 && !validatePortRange(value) && value !== '') {
                return { result: false, errMsg: '端口格式错误' }
            }
            if (value.indexOf('-') === -1 && !regex.test(value)) {
                return { result: false, errMsg: '端口格式错误' }
            }
        }
    } else {
        return { result: !!value, errMsg: "" }
    }
    return { result: !!value, errMsg: "" }
}
/*多个时间段*/
function validateMultiPeriod(value, obj) {
    value = value && value.trim();
    if (value) {
        let inputArr = value.replace(new RegExp(obj.splitSymbol, "g"), "$").split("$");
        if (obj.max < inputArr.length) {
            return { result: false, errMsg: '时间段个数超出限制' }
        }
        if (hasDuplicates(inputArr)) {
            return { result: false, errMsg: '时间段有重复值' }
        }
        const regex = /^(([0-2][0-3])|([0-1][0-9])):[0-5][0-9]$/;
        if (inputArr.length > 0) {
            for (let i = 0; i < inputArr.length; i++) {
                let value = inputArr[i].replace(/^\s+|\s+$/g, ''); //去除首尾空格
                if (value.indexOf('-') > -1 && (!regex.test(value.split('-')[0]) || !regex.test(value.split('-')[1]) || value.split('-')[0] === value.split('-')[1])) {
                    return { result: false, errMsg: '时间格式错误' }
                }
                if (value.indexOf('-') === -1) {
                    return { result: false, errMsg: '时间格式错误' }
                }
            }
        } else {
            return { result: !!value, errMsg: "" }
        }
    }

    return { result: !!value, errMsg: "" }
}

function hasDuplicates(a) {
    return _.uniq(a).length !== a.length;
}
/*多个邮箱*/
function validateMultiEmail(value, obj) {
    console.log(value);
    value = value && typeof(value) === 'string' ? value.trim() : value;
    if (value) {
        if (Array.isArray(value)) {
            value = value.toString();
        }
        let inputArr = value.replace(new RegExp(obj.splitSymbol, "g"), "$").split("$");
        console.log(inputArr)
        if (obj.max < inputArr.length) {
            //输入个数超出限制
            return { result: false, errMsg: window.vm.$t('noticeOut.error6') }
        }
        if (hasDuplicates(inputArr)) {
            //邮箱有重复值
            return { result: false, errMsg: window.vm.$t('sysMan.erroemail1') }
        }
        const regex = /^(?:[a-z\d]+[_\-\+\.]?)*[a-z\d]+@(?:([a-z\d]+\-?)*[a-z\d]+\.)+([a-z]{2,})+$/
        if (inputArr.length > 0) {
            for (let i = 0; i < inputArr.length; i++) {
                let value = inputArr[i].replace(/^\s+|\s+$/g, ''); //去除首尾空格
                if (!regex.test(value)) {
                    return { result: false, errMsg: window.vm.$t('sysMan.erroemail') }
                }
            }
        } else {
            return { result: !!value, errMsg: "" }
        }
    }
    return { result: !!value, errMsg: window.vm.$t('sysMan.enteremail') }
}

/*多个网址*/
function validateMultiUrl(value, obj) {
    let reg = '';
    if (obj.type === 'domain') {
        reg = "^((https|http|ftp|rtsp|mms)?://)" +
            "?(([0-9a-zA-Z_!~*'().&=+$%-]+: )?[0-9a-zA-Z_!~*'().&=+$%-]+@)?" //ftp的user@
            +
            "(([0-9]{1,3}\.){3}[0-9]{1,3}" // IP形式的URL- 199.194.52.184
            +
            "|" +
            "\\[((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\]" +
            "|" // 允许IP和DOMAIN（域名）
            +
            "([0-9a-zA-Z_!~*'()-]+\.)*" // 域名- www.
            +
            "([0-9a-zA-Z][0-9a-zA-Z-]{0,61})?[0-9a-zA-Z]\." // 二级域名
            +
            "[a-zA-Z]{2,6})" // first level domain- .com or .museum
            +
            "(:(6[0-4]\\d{4}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5]|[1-5]\\d{4}|[1-9]\\d{1,3}|[0-9]))?" // 端口- :80
            +
            "((/?)|" // a slash isn't required if there is no file name
            +
            "(/[0-9a-zA-Z_!~*'().;?:@&=+$,%#-]+)+/?)$";
    } else if (obj.type === 'url') {
        reg = "^((https|http|ftp|rtsp|mms)://)" +
            "(([0-9a-zA-Z_!~*'().&=+$%-]+: )?[0-9a-zA-Z_!~*'().&=+$%-]+@)?" //ftp的user@
            +
            "(([0-9]{1,3}\.){3}[0-9]{1,3}" // IP形式的URL- 199.194.52.184
            +
            "|" +
            "\\[((((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))|::))\\]" +
            "|" // 允许IP和DOMAIN（域名）
            +
            "([0-9a-zA-Z_!~*'()-]+\.)*" // 域名- www.
            +
            "([0-9a-zA-Z][0-9a-zA-Z-]{0,61})?[0-9a-zA-Z]\." // 二级域名
            +
            "[a-zA-Z]{2,6})" // first level domain- .com or .museum
            +
            "(:(6[0-4]\\d{4}|65[0-4]\\d{2}|655[0-2]\\d|6553[0-5]|[1-5]\\d{4}|[1-9]\\d{1,3}|[0-9]))?" // 端口- :80
            +
            "((/?)|" // a slash isn't required if there is no file name
            +
            "(/[0-9a-zA-Z_!~*'().;?:@&=+$,%#-]+)+/?)$";
    }
    const regex = new RegExp(reg);
    value = value && value.trim();
    if (value) {
        let urlList = value.replace(new RegExp(obj.splitSymbol, "g"), "$").split("$");
        if (urlList.length > obj.max) {
            return { result: false, errMsg: "超出最大限制数" }
        }
        /* if (hasDuplicates(urlList)) {
             return { result: false, errMsg: obj.type === 'url'?'url有重复值，请检查':'域名有重复值，请检查' }
         }*/
        /*判断每一个url是否符合要求*/
        for (let i = 0; i < urlList.length; i++) {
            let urlVal = urlList[i].replace(/^\s+|\s+$/g, ''); //去除首尾空格
            if (urlVal && !regex.test(urlVal)) {
                return { result: false, errMsg: "格式错误" }
            }
        }
    } else {
        return { result: !!value, errMsg: "" }
    }
    return { result: !!value, errMsg: "" }
}

/*多个域名*/
function validateMultiDomain(value, obj) {
    value = value && value.trim();
    if (value) {
        let inputArr = value.replace(new RegExp(obj.splitSymbol, "g"), "$").split("$");
        if (obj.max < inputArr.length) {
            return { result: false, errMsg: '域名个数超出限制' }
        }
        if (hasDuplicates(inputArr)) {
            return { result: false, errMsg: '域名有重复值，请检查' }
        }
        const regex = /^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z]{2,})+$/
        if (inputArr.length > 0) {
            for (let i = 0; i < inputArr.length; i++) {
                let value = inputArr[i].replace(/^\s+|\s+$/g, ''); //去除首尾空格
                if (!regex.test(value)) {
                    return { result: false, errMsg: '域名格式有误' }
                }
            }
        } else {
            return { result: !!value, errMsg: "" }
        }
    }
    return { result: !!value, errMsg: "" }
}
/*自定义多个输入校验*/
function validateMultiSelfDefine(value, obj) {
    value = value && value.trim();
    if (value) {
        let inputArr = value.replace(new RegExp(obj.splitSymbol, "g"), "$").split("$");
        if (obj.max < inputArr.length) {
            return { result: false, errMsg: '个数超出限制' }
        }
        if (hasDuplicates(inputArr)) {
            return { result: false, errMsg: '有重复值，请检查' }
        }
        const regex = new RegExp(obj.reg); //字母数字下划线
        if (inputArr.length > 0) {
            for (let i = 0; i < inputArr.length; i++) {
                let value = inputArr[i].replace(/^\s+|\s+$/g, ''); //去除首尾空格
                if (!regex.test(value)) {
                    return { result: false, errMsg: '格式有误' }
                }
            }
        } else {
            return { result: !!value, errMsg: "" }
        }
    }
    return { result: !!value, errMsg: "" }
}
/*多个输入规则定义*/
export const multiRules = {
    IP(value, params) {
        return validateMultiIp(value, params)
    },
    port(value, params) {
        return validateMultiPort(value, params)
    },
    period(value, params) {
        return validateMultiPeriod(value, params)
    },
    email(value, params) {
        return validateMultiEmail(value, params)
    },
    url(value, params) {
        return validateMultiUrl(value, params)
    },
    Domain(value, params) {
        return validateMultiDomain(value, params)
    },
    SelfDefine(value, params) {
        return validateMultiSelfDefine(value, params)
    }
};
/*
 * 输入多行校验，
 * @params:required：默认值：true,是否为必输字段
 * @params:type：类型，校验的字段
 * @params:trigger：默认值：blur,输入框失去焦点校验
 * @params:nullMsg：默认值："",为空时提示信息
 * @params:config：配置，默认值{max:10000 -- 最多可输入10000个，splitSymbol:([,]|[;]||\s)+  --- 多行输入分隔符,默认为,;换行}
 */
export function validateMulti(required = true, type, trigger = "blur", nullMsg = "", config = {
    max: 10000
}) {
    //默认配置
    let defaultConfig = {
        max: 10000,
        splitSymbol: '([,]|[;]|\\n|\\s)+',
        ipType: 'all',
        reg: ''
    };
    const rule = { required: !!required, trigger }
    let emptyMsg = nullMsg + '不能为空';
    let check = null; //是否存在校验规则
    if (typeof(type) === "function") {
        check = type
    } else {
        check = type ? multiRules[type] : null;
    }
    if (check) {
        rule.validator = (r, v, c) => {
            const { result, errMsg } = check(v, _.merge(defaultConfig, config)); //result校验结果  errMsg错误提示
            if (required) {
                //必填项
                return (v === null || v === undefined || (v + '').trim() === "") ? c(new Error(emptyMsg)) : result ? c() : c(new Error(errMsg))

            }
            //选填项:
            return (v === null || v === undefined || (v + '').trim() === "" || result) ? c() : c(new Error(errMsg))
        }
    } else {
        rule.message = emptyMsg
    }

    return [rule]
}
```